{"version":3,"sources":["webpack://technologii-truda/./node_modules/suggestions-jquery/dist/js/jquery.suggestions.js"],"names":["$","hasOwnProperty","counter","lang_util","isArray","array","Array","isFunction","it","Object","prototype","toString","call","isEmptyObject","obj","keys","length","constructor","isPlainObject","undefined","nodeType","window","collection_util","compact","filter","el","each","callback","some","idx","key","value","intersect","array1","array2","result","indexOf","minus","makeArray","arrayLike","slice","minusWithPartialMatching","el2","start","func_util","delay","handler","setTimeout","object_util","areSame","self","a","b","same","i","assign","target","varArgs","apply","arguments","TypeError","to","index","nextSource","nextKey","clone","JSON","parse","stringify","copy","val","fieldsAreNotEmpty","fields","field","getDeepValue","name","path","split","step","shift","join","indexObjectsById","objectsArray","idField","indexField","KEYS","ENTER","ESC","TAB","SPACE","UP","DOWN","CLASSES","hint","mobile","nowrap","promo","selected","suggestion","subtext","subtext_inline","subtext_delimiter","subtext_label","removeConstraint","EVENT_NS","DATA_ATTR_KEY","WORD_DELIMITERS","WORD_PARTS_DELIMITERS","WORD_SPLITTER","RegExp","WORD_PARTS_SPLITTER","text_util","escapeHtml","str","map","html","ch","replace","escapeRegExChars","formatToken","token","toLowerCase","getWordExtractorRegExp","normalize","stopwords","padEnd","sourceString","targetLength","padString","String","repeat","cleanStr","words","lastWord","pop","goodWords","push","splitTokens","tokens","subtokens","concat","stringEncloses","str1","str2","tokenize","unformattableTokens","preferredTokens","otherTokens","withSubTokens","jqapi","Deferred","ajax","settings","extend","isJqObject","param","proxy","func","context","select","selector","supportsCors","support","cors","getDefaultType","getDefaultContentType","fixURLProtocol","url","location","protocol","addUrlParams","params","test","serialize","data","generateId","prefix","utils","reWordExtractor","arrayMinus","arrayMinusWithPartialMatching","arraysIntersection","compactObject","fieldsNotEmpty","indexBy","uniqueId","DEFAULT_OPTIONS","$helpers","autoSelectFirst","containerClass","count","deferRequestBy","enrichmentEnabled","formatResult","formatSelected","headers","initializeInterval","language","minChars","mobileWidth","noCache","noSuggestionsHint","onInvalidateSelection","onSearchComplete","noop","onSearchError","onSearchStart","onSelect","onSelectNothing","onSuggestionsFetch","paramName","preventBadQueries","requestMode","scrollOnFocus","serviceUrl","tabDisabled","timeout","triggerSelectOnBlur","triggerSelectOnEnter","triggerSelectOnSpace","type","sameParentChecker","preprocessFn","suggestions","parentValue","haveSameParent","_matchByWords","parentCheckerFn","query","queryTokens","matches","suggestedValue","suggestionWords","componentsUnderCityDistrict","_underCityDistrict","matchers","matchByNormalizedQuery","normalizedQuery","matchByWords","matchByWordsAddress","matchByFields","fieldValue","fieldWords","ADDRESS_STOPWORDS","ADDRESS_COMPONENTS","id","forBounds","forLocations","kladrFormat","digits","zeros","fiasType","ADDRESS_TYPE","urlSuffix","dataComponents","dataComponentsById","enrichmentMethod","enrichmentParams","locations","locations_boost","from_bound","to_bound","getEnrichmentQuery","unrestricted_value","geoEnabled","isDataComplete","this","bounds","composeValue","options","country","region","region_with_type","region_type","region_type_full","area","area_with_type","area_type","area_type_full","city","city_with_type","city_type","city_type_full","settelement","settlement_with_type","settlement_type","settlement","settlement_type_full","cityDistrict","city_district_with_type","city_district_type","city_district","city_district_type_full","street","street_with_type","street_type","street_type_full","house","stead_type","stead","house_type","block_type","block","flat","flat_type","postal_box","saveCityDistrict","excludeCityDistrict","city_district_fias_id","forEach","component","currentValue","unusedTokens","formattedHistoryValues","that","district","historyValues","history_values","findUnusedTokens","getFormattedHistoryValues","highlightMatches","wrapFormattedValue","own","copyDataComponents","classes","values","formatted","historyValue","getSuggestionValue","instance","formattedValue","hasSameValues","restrict_value","getValueWithinConstraints","getValueWithinBounds","hasBeenEnriched","getUnrestrictedData","FIAS_COMPONENTS","FIAS_TYPE","planning_structure","planning_structure_with_type","planning_structure_type","planning_structure_type_full","valueStartsWith","NAME_TYPE","fieldNames","surname","patronymic","element","parts","part","innPartsLengths","LEGAL","INDIVIDUAL","chooseFormattedField","formattedMain","formattedAlt","rHasMatch","formattedField","main","alt","PARTY_TYPE","hid","formattedInnOGRN","formatResultInn","formattedFIO","address","isMobile","maxLength","innParts","formattedInn","inn","innPartsLength","rDigit","partLength","formattedPart","EMAIL_TYPE","isQueryRequestable","suggest_local","BANK_TYPE","bic","formattedBIC","Outward","types","NAME","ADDRESS","FIAS","PARTY","EMAIL","BANK","notificator","chains","on","method","get","serviceMethods","suggest","defaultParams","dataType","contentType","addTypeInUrl","status","findById","requestModes","userSelect","updateValue","Suggestions","badQueries","selectedIndex","intervalId","cachedResponse","enrichmentCache","currentRequest","inputPhase","fetchPhase","enrichPhase","onChangeTimeout","triggering","$wrapper","disabled","selection","$viewport","$body","document","body","setupElement","initializer","is","resolve","deferInitialization","done","initialize","createWrapper","notify","bindWindowEvents","setOptions","inferIsMobile","timer","events","enable","always","off","clearInterval","setInterval","isInitialized","state","dispose","reject","removeData","removeClass","unbindWindowEvents","removeWrapper","trigger","chainName","args","after","onMousedown","remove","e","preventDefault","cancelBlur","closest","one","$elements","add","floating","$container","contains","hide","scrollToTop","scrollTarget","animate","scrollTop","offset","top","suppliedOptions","option","available","disable","width","clearCache","clear","currentSelection","abortRequest","visible","isUnavailable","update","updateSuggestions","setSuggestion","checkValueBounds","all","kladr_id","getBoundedKladrId","fixData","fullQuery","extendedCurrentValue","resolver","selectSuggestion","fail","getSuggestions","parentInstance","getParentInstance","trim","getAjaxParams","custom","partner","serviceMethod","version","xhrFields","withCredentials","constructRequestParams","customParams","hookParams","isNumeric","assignSuggestions","requestOptions","response","noCallbacks","useEnrichmentCache","cacheKey","isBadQuery","doGetSuggestions","processResponse","enrichResponse","jqXHR","textStatus","errorThrown","request","q","abort","verifySuggestionsFormat","setUnrestrictedValues","selectionOptions","typeFormattedValue","hasSame","anotherSuggestion","shouldRestrictValues","constraints","shouldRestrict","label","getFirstConstraintLabel","areSuggestionsSame","getNoSuggestionsHint","methods","attr","addClass","css","bindElementEvents","onElementKeyDown","onElementKeyUp","onElementBlur","onElementFocus","unbindElementEvents","selectCurrentValue","noSpace","cancelFocus","completeOnFocus","which","isCursorAtEnd","continueSelecting","dontEnrich","proceedChangedValue","moveUp","moveDown","stopImmediatePropagation","triggerOnSelectNothing","clearTimeout","onValueChange","isElementFocused","setCursorAtEnd","activeElement","isElementDisabled","Boolean","getAttribute","selectionStart","range","valLength","ex","createRange","moveStart","text","selectionEnd","scrollLeft","scrollWidth","statusRequests","resetTokens","req","locationRequest","methods$1","checkStatus","requestKey","triggerError","search","plan","getResponseHeader","statusText","defaultGeoLocation","resetLocation","geoLocation","methods$2","checkLocation","providedLocation","resp","locationData","getGeoLocation","constructParams","promise","methods$3","enrichSuggestion","qc","disableDropdown","enableDropdown","enrichedSuggestion","chunks","chunk","matched","nowrapLinkedParts","formattedStr","nowrapClass","delimitedParts","hasAnotherSuggestion","s","optionsUsed","methods$4","createContainer","suggestionSelector","display","onSuggestionClick","showContainer","appendTo","getContainer","removeContainer","setContainerOptions","mousedownEvent","$el","dropdownDisabled","focus","isNaN","getSuggestionsItems","children","toggleDropdownEnabling","hasSuggestionsToChoose","buildSuggestionHtml","eq","beforeRender","show","ordinal","labels","makeSuggestionLabel","tokenMatchers","match","word","rWords","exec","hasUpperCase","matchable","inArray","j","matcher","tokenMatch","nextIndex","before","beforeText","beforeDelimiter","splice","substr","nameData","empty","activate","$activeItem","$children","deactivate","restoreValue","adjustScroll","itemTop","itemBottom","containerHeight","position","outerHeight","innerHeight","optionsUsed$1","fiasParamNames","belongsToArea","parentSuggestion","bound","getSignificantKladrId","significantKladrId","significantLength","ConstraintLocation","fiasFieldNames","fiasFields","specificity","fieldName","getFiasSpecificity","significantKladr","getKladrSpecificity","getLabel","getFields","isValid","kladrLength","containsData","Constraint","deletable","locationsArray","restrictions","methods$5","createConstraints","setupConstraints","$parent","unbindFromParent","bindToParent","_","constraint","addConstraint","filteredLocation","locationComponents","constructConstraintsParams","parentData","city_fias_id","constraints_id","onParentSelectionChanged","onParentDispose","valueChanged","shareWithParent","restrictedKeys","unrestrictedData","maxSpecificity","region_kladr_id","city_kladr_id","methods$6","proceedQuery","findSuggestionIndex","selectFoundSuggestion","onSelectComplete","newSelectionOptions","lastValue","assumeDataComplete","alwaysContinueSelecting","event","optionsUsed$2","methods$7","setupBounds","from","setBoundsOptions","boundIsOwn","boundsAvailable","newBounds","boundFrom","boundTo","boundsOwn","boundsAll","constructBoundsParams","valueData","components","boundsRange","dom","selectByClass","classname","parent","querySelector","className","list","setStyle","style","listenTo","eventName","namespace","addEventListener","eventsByNamespace","stopListeningNamespace","removeEventListener","FREE_PLAN","LINK","PREFIX","SUFFIX","IMAGE","Promo","plugin","container","setStyles","setHtml","innerHTML","defaultOptions","fn","first","inputElement","factory"],"mappings":"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KACA,MACA,QACA,SACA,KACA,IACA,MACA,MACA,OACA,OACA,MACA,MACA,UACA,KACA,QACA,QACA,SACA,aACA,UACA,QACA,SACA,WACA,SACA,UACA,WACA,SACA,UACA,UACA,MACA,MACA,SACA,KACA,OACA,IACA,MACA,OACA,MACA,MACA,MACA,MACA,QACA,KACA,MACA,QACA,KACA,QACA,MACA,MACA,QACA,MACA,IACA,KACA,OACA,MACA,QACA,IACA,IACA,UACA,WACA,UACA,uBACA,QACA,UACA,eACA,SACA,UACA,WACA,UACA,SACA,QACA,aACA,WACA,aACA,aACA,UACA,WACA,YACA,WACA,UACA,YACA,UACA,WACA,UACA,QACA,aACA,OACA,YACA,UACA,aACA,UACA,UACA,WACA,aACA,QACA,QACA,OACA,UACA,QACA,SAaAC,EAAqB,CACrB,CACIC,GAAI,WACJ7K,OAAQ,CAAC,YACT8K,WAAW,EACXC,cAAc,GAElB,CACIF,GAAI,cACJ7K,OAAQ,CAAC,eACT8K,WAAW,EACXC,cAAc,GAElB,CACIF,GAAI,mBACJ7K,OAAQ,CAAC,oBACT8K,WAAW,EACXC,cAAc,GAElB,CACIF,GAAI,UACJ7K,OAAQ,CAAC,WACT8K,WAAW,EACXC,cAAc,EACdC,YAAa,CAAEC,OAAQ,EAAGC,MAAO,IACjCC,SAAU,oBAEd,CACIN,GAAI,kBACJ7K,OAAQ,CAAC,mBACT8K,WAAW,EACXC,cAAc,GAElB,CACIF,GAAI,iBACJ7K,OAAQ,CAAC,kBACT8K,WAAW,EACXC,cAAc,GAElB,CACIF,GAAI,mBACJ7K,OAAQ,CAAC,oBACT8K,WAAW,EACXC,cAAc,EACdC,YAAa,CAAEC,OAAQ,EAAGC,MAAO,IACjCC,SAAU,kBAEd,CACIN,GAAI,SACJ7K,OAAQ,CACJ,SACA,cACA,mBACA,oBAEJ8K,WAAW,EACXC,cAAc,EACdC,YAAa,CAAEC,OAAQ,EAAGC,MAAO,IACjCC,SAAU,kBAEd,CACIN,GAAI,eACJ7K,OAAQ,CAAC,gBACT8K,WAAW,EACXC,cAAc,GAElB,CACIF,GAAI,iBACJ7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","file":"js/645.js","sourcesContent":["/**\n * DaData.ru Suggestions jQuery plugin, version 22.6.0\n *\n * DaData.ru Suggestions jQuery plugin is freely distributable under the terms of MIT-style license\n * Built on DevBridge Autocomplete for jQuery (https://github.com/devbridge/jQuery-Autocomplete)\n * For details, see https://github.com/hflabs/suggestions-jquery\n */\n(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? factory(require('jquery')) :\n\ttypeof define === 'function' && define.amd ? define(['jquery'], factory) :\n\t(factory(global.jQuery));\n}(this, (function ($) { 'use strict';\n\n$ = $ && $.hasOwnProperty('default') ? $['default'] : $;\n\n/**\n *     .\n */\nvar lang_util = {\n    /**\n     * ,    .\n     */\n    isArray: function(array) {\n        return Array.isArray(array);\n    },\n\n    /**\n     * ,    .\n     */\n    isFunction: function(it) {\n        return Object.prototype.toString.call(it) === \"[object Function]\";\n    },\n\n    /**\n     * ,      ({}).\n     */\n    isEmptyObject: function(obj) {\n        return Object.keys(obj).length === 0 && obj.constructor === Object;\n    },\n\n    /**\n     * ,     \n     * ( undefiend,  null,  DOM-)\n     */\n    isPlainObject: function(obj) {\n        if (\n            obj === undefined ||\n            typeof obj !== \"object\" ||\n            obj === null ||\n            obj.nodeType ||\n            obj === obj.window\n        ) {\n            return false;\n        }\n        if (\n            obj.constructor &&\n            !Object.prototype.hasOwnProperty.call(\n                obj.constructor.prototype,\n                \"isPrototypeOf\"\n            )\n        ) {\n            return false;\n        }\n        return true;\n    }\n};\n\n/**\n *     .\n */\nvar collection_util = {\n    /**\n     *     \n     */\n    compact: function(array) {\n        return array.filter(function(el) {\n            return !!el;\n        });\n    },\n\n    /**\n     *       .\n     *    $.each() - ,  -  false.\n     * @param {Object|Array} obj -   \n     * @param {eachCallback} callback - -\n     */\n    each: function(obj, callback) {\n        if (Array.isArray(obj)) {\n            obj.some(function(el, idx) {\n                return callback(el, idx) === false;\n            });\n            return;\n        }\n        Object.keys(obj).some(function(key) {\n            var value = obj[key];\n            return callback(value, key) === false;\n        });\n    },\n\n    /**\n     *  : ([1,2,3,4], [2,4,5,6]) => [2,4]\n     *    .\n     */\n    intersect: function(array1, array2) {\n        var result = [];\n        if (!Array.isArray(array1) || !Array.isArray(array2)) {\n            return result;\n        }\n        return array1.filter(function(el) {\n            return array2.indexOf(el) !== -1;\n        });\n    },\n\n    /**\n     *  : ([1,2,3,4], [2,4,5,6]) => [1,3]\n     *    .\n     */\n    minus: function(array1, array2) {\n        if (!array2 || array2.length === 0) {\n            return array1;\n        }\n        return array1.filter(function(el) {\n            return array2.indexOf(el) === -1;\n        });\n    },\n\n    /**\n     *     .\n     *   ,   .\n     */\n    makeArray: function(arrayLike) {\n        if (lang_util.isArray(arrayLike)) {\n            return Array.prototype.slice.call(arrayLike);\n        } else {\n            return [arrayLike];\n        }\n    },\n\n    /**\n     *      .\n     *         ,\n     *   .\n     */\n    minusWithPartialMatching: function(array1, array2) {\n        if (!array2 || array2.length === 0) {\n            return array1;\n        }\n        return array1.filter(function(el) {\n            return !array2.some(function(el2) {\n                return el2.indexOf(el) === 0;\n            });\n        });\n    },\n\n    /**\n     *  ,    .\n     * @param obj - \n     * @param start - ,     \n     */\n    slice: function(obj, start) {\n        return Array.prototype.slice.call(obj, start);\n    }\n};\n\n/**\n *     .\n */\nvar func_util = {\n    /**\n     *     .\n     * @param {Function} handler - \n     * @param {number} delay -   \n     */\n    delay: function(handler, delay) {\n        return setTimeout(handler, delay || 0);\n    }\n};\n\n/**\n *     .\n */\nvar object_util = {\n    /**\n     *     ,    \n     * @returns {boolean} true,   , false   \n     */\n    areSame: function self(a, b) {\n        var same = true;\n\n        if (typeof a != typeof b) {\n            return false;\n        }\n\n        if (typeof a == \"object\" && a != null && b != null) {\n            collection_util.each(a, function(value, i) {\n                return (same = self(value, b[i]));\n            });\n            return same;\n        }\n\n        return a === b;\n    },\n\n    /**\n     *          \n     */\n    assign: function(target, varArgs) {\n        if (typeof Object.assign === \"function\") {\n            return Object.assign.apply(null, arguments);\n        }\n        if (target == null) {\n            // TypeError if undefined or null\n            throw new TypeError(\"Cannot convert undefined or null to object\");\n        }\n\n        var to = Object(target);\n\n        for (var index = 1; index < arguments.length; index++) {\n            var nextSource = arguments[index];\n\n            if (nextSource != null) {\n                // Skip over if undefined or null\n                for (var nextKey in nextSource) {\n                    // Avoid bugs when hasOwnProperty is shadowed\n                    if (\n                        Object.prototype.hasOwnProperty.call(\n                            nextSource,\n                            nextKey\n                        )\n                    ) {\n                        to[nextKey] = nextSource[nextKey];\n                    }\n                }\n            }\n        }\n        return to;\n    },\n\n    /**\n     *    \n     */\n    clone: function(obj) {\n        return JSON.parse(JSON.stringify(obj));\n    },\n\n    /**\n     *      \n     * ( undefined, null  '')\n     * @param obj\n     */\n    compact: function(obj) {\n        var copy = object_util.clone(obj);\n\n        collection_util.each(copy, function(val, key) {\n            if (val === null || val === undefined || val === \"\") {\n                delete copy[key];\n            }\n        });\n\n        return copy;\n    },\n\n    /**\n     * ,      .\n     * @param {Object} obj -  \n     * @param {Array} fields -   ,   \n     * @returns {boolean}\n     */\n    fieldsAreNotEmpty: function(obj, fields) {\n        if (!lang_util.isPlainObject(obj)) {\n            return false;\n        }\n        var result = true;\n        collection_util.each(fields, function(field, i) {\n            result = !!obj[field];\n            return result;\n        });\n        return result;\n    },\n\n    /**\n     *      \n     * , 'data.address.value'\n     */\n    getDeepValue: function self(obj, name) {\n        var path = name.split(\".\"),\n            step = path.shift();\n\n        return (\n            obj && (path.length ? self(obj[step], path.join(\".\")) : obj[step])\n        );\n    },\n\n    /**\n     *      .\n     *        .\n     *  ,       ,\n     *      .\n     *       .\n     * @param {Array} objectsArray -  \n     * @param {string} idField -   \n     * @param {string} indexField -     \n     * @return {Object}     \n     */\n    indexObjectsById: function(objectsArray, idField, indexField) {\n        var result = {};\n\n        collection_util.each(objectsArray, function(obj, idx) {\n            var key = obj[idField];\n            var val = {};\n\n            if (indexField) {\n                val[indexField] = idx;\n            }\n\n            result[key] = object_util.assign(val, obj);\n        });\n\n        return result;\n    }\n};\n\nvar KEYS = {\n    ENTER: 13,\n    ESC: 27,\n    TAB: 9,\n    SPACE: 32,\n    UP: 38,\n    DOWN: 40\n};\n\nvar CLASSES = {\n    hint: \"suggestions-hint\",\n    mobile: \"suggestions-mobile\",\n    nowrap: \"suggestions-nowrap\",\n    promo: \"suggestions-promo\",\n    selected: \"suggestions-selected\",\n    suggestion: \"suggestions-suggestion\",\n    subtext: \"suggestions-subtext\",\n    subtext_inline: \"suggestions-subtext suggestions-subtext_inline\",\n    subtext_delimiter: \"suggestions-subtext-delimiter\",\n    subtext_label: \"suggestions-subtext suggestions-subtext_label\",\n    removeConstraint: \"suggestions-remove\",\n    value: \"suggestions-value\"\n};\n\nvar EVENT_NS = \".suggestions\";\nvar DATA_ATTR_KEY = \"suggestions\";\nvar WORD_DELIMITERS = \"\\\\s\\\"'~\\\\*\\\\.,:\\\\|\\\\[\\\\]\\\\(\\\\)\\\\{\\\\}<>\";\nvar WORD_PARTS_DELIMITERS = \"\\\\-\\\\+\\\\\\\\\\\\?!@#$%^&\";\n\n/**\n *     .\n */\n\nvar WORD_SPLITTER = new RegExp(\"[\" + WORD_DELIMITERS + \"]+\", \"g\");\nvar WORD_PARTS_SPLITTER = new RegExp(\"[\" + WORD_PARTS_DELIMITERS + \"]+\", \"g\");\n\nvar text_util = {\n    /**\n     *  ,      \n     *  HTML-\n     */\n    escapeHtml: function(str) {\n        var map = {\n            \"&\": \"&amp;\",\n            \"<\": \"&lt;\",\n            \">\": \"&gt;\",\n            '\"': \"&quot;\",\n            \"'\": \"&#x27;\",\n            \"/\": \"&#x2F;\"\n        };\n\n        if (str) {\n            collection_util.each(map, function(html, ch) {\n                str = str.replace(new RegExp(ch, \"g\"), html);\n            });\n        }\n        return str;\n    },\n\n    /**\n     *   RegExp-  \n     * (     )\n     */\n    escapeRegExChars: function(value) {\n        return value.replace(/[\\-\\[\\]\\/\\{\\}\\(\\)\\*\\+\\?\\.\\\\\\^\\$\\|]/g, \"\\\\$&\");\n    },\n\n    /**\n     *          \n     */\n    formatToken: function(token) {\n        return token && token.toLowerCase().replace(/[]/g, \"\");\n    },\n\n    /**\n     *        \n     */\n    getWordExtractorRegExp: function() {\n        return new RegExp(\n            \"([^\" + WORD_DELIMITERS + \"]*)([\" + WORD_DELIMITERS + \"]*)\",\n            \"g\"\n        );\n    },\n\n    /**\n     *    -\n     */\n    normalize: function(str, stopwords) {\n        return text_util.split(str, stopwords).join(\" \");\n    },\n\n    /**\n     *        \n     * @param sourceString   \n     * @param targetLength     \n     * @param padString    \n     * @returns   \n     */\n    padEnd: function(sourceString, targetLength, padString) {\n        if (String.prototype.padEnd) {\n            return sourceString.padEnd(targetLength, padString);\n        }\n        targetLength = targetLength >> 0; //floor if number or convert non-number to 0;\n        padString = String(typeof padString !== \"undefined\" ? padString : \" \");\n        if (sourceString.length > targetLength) {\n            return String(sourceString);\n        } else {\n            targetLength = targetLength - sourceString.length;\n            if (targetLength > padString.length) {\n                padString += padString.repeat(targetLength / padString.length); //append to original to ensure we are longer than needed\n            }\n            return String(sourceString) + padString.slice(0, targetLength);\n        }\n    },\n\n    /**\n     *  ,   ,\n     *  -  .\n     *    ,  .\n     */\n    split: function(str, stopwords) {\n        var cleanStr = str\n            .toLowerCase()\n            .replace(\"\", \"\")\n            .replace(/(\\d+)([-]{2,})/g, \"$1 $2\")\n            .replace(/([-]+)(\\d+)/g, \"$1 $2\");\n\n        var words = collection_util.compact(cleanStr.split(WORD_SPLITTER));\n        if (!words.length) {\n            return [];\n        }\n        var lastWord = words.pop();\n        var goodWords = collection_util.minus(words, stopwords);\n        goodWords.push(lastWord);\n        return goodWords;\n    },\n\n    /**\n     *     .\n     *    withSubTokens,    .\n     */\n    splitTokens: function(tokens) {\n        var result = [];\n        collection_util.each(tokens, function(token, i) {\n            var subtokens = token.split(WORD_PARTS_SPLITTER);\n            result = result.concat(collection_util.compact(subtokens));\n        });\n        return result;\n    },\n\n    /**\n     * ,    1  2.\n     *   ,  false.\n     */\n    stringEncloses: function(str1, str2) {\n        return (\n            str1.length > str2.length &&\n            str1.toLowerCase().indexOf(str2.toLowerCase()) !== -1\n        );\n    },\n\n    /**\n     *     .\n     *       \n     * (,      ).\n     *      .\n     * @param {string} value - \n     * @param {Array} unformattableTokens - \n     * @return {Array}   \n     */\n    tokenize: function(value, unformattableTokens) {\n        var tokens = collection_util.compact(\n            text_util.formatToken(value).split(WORD_SPLITTER)\n        );\n        // Move unformattableTokens to the end.\n        // This will help to apply them only if no other tokens match\n        var preferredTokens = collection_util.minus(\n            tokens,\n            unformattableTokens\n        );\n        var otherTokens = collection_util.minus(tokens, preferredTokens);\n        tokens = text_util.withSubTokens(preferredTokens.concat(otherTokens));\n        return tokens;\n    },\n\n    /**\n     *     \n     *      .\n     * @param {Array} tokens - \n     * @return {Array}   \n     */\n    withSubTokens: function(tokens) {\n        var result = [];\n        collection_util.each(tokens, function(token, i) {\n            var subtokens = token.split(WORD_PARTS_SPLITTER);\n            result.push(token);\n            if (subtokens.length > 1) {\n                result = result.concat(collection_util.compact(subtokens));\n            }\n        });\n        return result;\n    }\n};\n\n/**\n * jQuery API.\n */\nvar jqapi = {\n    Deferred: function() {\n        return $.Deferred();\n    },\n\n    ajax: function(settings) {\n        return $.ajax(settings);\n    },\n\n    extend: function() {\n        return $.extend.apply(null, arguments);\n    },\n\n    isJqObject: function(obj) {\n        return obj instanceof $;\n    },\n\n    param: function(obj) {\n        return $.param(obj);\n    },\n\n    proxy: function(func, context) {\n        return $.proxy(func, context);\n    },\n\n    select: function(selector) {\n        return $(selector);\n    },\n\n    supportsCors: function() {\n        return $.support.cors;\n    }\n};\n\n/**\n *     AJAX\n */\nvar ajax = {\n    /**\n     * HTTP-,   \n     */\n    getDefaultType: function() {\n        return jqapi.supportsCors() ? \"POST\" : \"GET\";\n    },\n\n    /**\n     * Content-type,   \n     */\n    getDefaultContentType: function() {\n        return jqapi.supportsCors()\n            ? \"application/json\"\n            : \"application/x-www-form-urlencoded\";\n    },\n\n    /**\n     *  HTTPS   ,     CORS\n     */\n    fixURLProtocol: function(url) {\n        return jqapi.supportsCors()\n            ? url\n            : url.replace(/^https?:/, location.protocol);\n    },\n\n    /**\n     *    GET-\n     */\n    addUrlParams: function(url, params) {\n        return url + (/\\?/.test(url) ? \"&\" : \"?\") + jqapi.param(params);\n    },\n\n    /**\n     *      .\n     *   JSON- (   CORS),\n     *     GET-.\n     */\n    serialize: function(data) {\n        if (jqapi.supportsCors()) {\n            return JSON.stringify(data, function(key, value) {\n                return value === null ? undefined : value;\n            });\n        } else {\n            data = object_util.compact(data);\n            return jqapi.param(data, true);\n        }\n    }\n};\n\n/**\n *   .\n * @param {string} prefix -   \n */\nvar generateId = (function() {\n    var counter = 0;\n    return function(prefix) {\n        return (prefix || \"\") + ++counter;\n    };\n})();\n\n/**\n *     .\n */\nvar utils = {\n    escapeRegExChars: text_util.escapeRegExChars,\n    escapeHtml: text_util.escapeHtml,\n    formatToken: text_util.formatToken,\n    normalize: text_util.normalize,\n    reWordExtractor: text_util.getWordExtractorRegExp,\n    stringEncloses: text_util.stringEncloses,\n\n    addUrlParams: ajax.addUrlParams,\n    getDefaultContentType: ajax.getDefaultContentType,\n    getDefaultType: ajax.getDefaultType,\n    fixURLProtocol: ajax.fixURLProtocol,\n    serialize: ajax.serialize,\n\n    arrayMinus: collection_util.minus,\n    arrayMinusWithPartialMatching: collection_util.minusWithPartialMatching,\n    arraysIntersection: collection_util.intersect,\n    compact: collection_util.compact,\n    each: collection_util.each,\n    makeArray: collection_util.makeArray,\n    slice: collection_util.slice,\n\n    delay: func_util.delay,\n\n    areSame: object_util.areSame,\n    compactObject: object_util.compact,\n    getDeepValue: object_util.getDeepValue,\n    fieldsNotEmpty: object_util.fieldsAreNotEmpty,\n    indexBy: object_util.indexObjectsById,\n\n    isArray: lang_util.isArray,\n    isEmptyObject: lang_util.isEmptyObject,\n    isFunction: lang_util.isFunction,\n    isPlainObject: lang_util.isPlainObject,\n\n    uniqueId: generateId\n};\n\nvar DEFAULT_OPTIONS = {\n    $helpers: null,\n    autoSelectFirst: false,\n    containerClass: \"suggestions-suggestions\",\n    count: 5,\n    deferRequestBy: 100,\n    enrichmentEnabled: true,\n    formatResult: null,\n    formatSelected: null,\n    headers: null,\n    hint: \"    \",\n    initializeInterval: 100,\n    language: null,\n    minChars: 1,\n    mobileWidth: 600,\n    noCache: false,\n    noSuggestionsHint: null,\n    onInvalidateSelection: null,\n    onSearchComplete: $.noop,\n    onSearchError: $.noop,\n    onSearchStart: $.noop,\n    onSelect: null,\n    onSelectNothing: null,\n    onSuggestionsFetch: null,\n    paramName: \"query\",\n    params: {},\n    preventBadQueries: false,\n    requestMode: \"suggest\",\n    scrollOnFocus: false,\n    //  url,   \n    serviceUrl: \"https://suggestions.dadata.ru/suggestions/api/4_1/rs\",\n    tabDisabled: false,\n    timeout: 3000,\n    triggerSelectOnBlur: true,\n    triggerSelectOnEnter: true,\n    triggerSelectOnSpace: false,\n    type: null,\n    // url,   serviceUrl + method + type\n    //  ,   ,        \n    //    cors   url    ?token=...&version=...\n    //       \n    url: null\n};\n\n/**\n * Factory to create same parent checker function\n * @param preprocessFn called on each value before comparison\n * @returns {Function} same parent checker function\n */\nfunction sameParentChecker(preprocessFn) {\n    return function(suggestions) {\n        if (suggestions.length === 0) {\n            return false;\n        }\n        if (suggestions.length === 1) {\n            return true;\n        }\n\n        var parentValue = preprocessFn(suggestions[0].value),\n            aliens = suggestions.filter(function(suggestion) {\n                return (\n                    preprocessFn(suggestion.value).indexOf(parentValue) !== 0\n                );\n            });\n\n        return aliens.length === 0;\n    };\n}\n\n/**\n * Default same parent checker. Compares raw values.\n * @type {Function}\n */\nvar haveSameParent = sameParentChecker(function(val) {\n    return val;\n});\n\n/**\n *   c ,  .\n * ,       \n * (   ).\n *  -.\n *     \n *  -1,     .\n */\nfunction _matchByWords(stopwords, parentCheckerFn) {\n    return function(query, suggestions) {\n        var queryTokens;\n        var matches = [];\n\n        if (parentCheckerFn(suggestions)) {\n            queryTokens = text_util.splitTokens(\n                text_util.split(query, stopwords)\n            );\n\n            collection_util.each(suggestions, function(suggestion, i) {\n                var suggestedValue = suggestion.value;\n\n                if (text_util.stringEncloses(query, suggestedValue)) {\n                    return false;\n                }\n\n                // check if query words are a subset of suggested words\n                var suggestionWords = text_util.splitTokens(\n                    text_util.split(suggestedValue, stopwords)\n                );\n\n                if (\n                    collection_util.minus(queryTokens, suggestionWords)\n                        .length === 0\n                ) {\n                    matches.push(i);\n                }\n            });\n        }\n\n        return matches.length === 1 ? matches[0] : -1;\n    };\n}\n\n/**\n * Matchers return index of suitable suggestion\n * Context inside is optionally set in types.js\n */\nvar matchers = {\n    /**\n     * Matches query against suggestions, removing all the stopwords.\n     */\n    matchByNormalizedQuery: function(stopwords) {\n        return function(query, suggestions) {\n            var normalizedQuery = text_util.normalize(query, stopwords);\n            var matches = [];\n\n            collection_util.each(suggestions, function(suggestion, i) {\n                var suggestedValue = suggestion.value.toLowerCase();\n                // if query encloses suggestion, than it has already been selected\n                // so we should not select it anymore\n                if (text_util.stringEncloses(query, suggestedValue)) {\n                    return false;\n                }\n                // if there is suggestion that contains query as its part\n                // than we should ignore all other matches, even full ones\n                if (suggestedValue.indexOf(normalizedQuery) > 0) {\n                    return false;\n                }\n                if (\n                    normalizedQuery ===\n                    text_util.normalize(suggestedValue, stopwords)\n                ) {\n                    matches.push(i);\n                }\n            });\n\n            return matches.length === 1 ? matches[0] : -1;\n        };\n    },\n\n    matchByWords: function(stopwords) {\n        return _matchByWords(stopwords, haveSameParent);\n    },\n\n    matchByWordsAddress: function(stopwords) {\n        return _matchByWords(stopwords, haveSameParent);\n    },\n\n    /**\n     * Matches query against values contained in suggestion fields\n     * for cases, when there is only one suggestion\n     * only considers fields specified in fields map\n     * uses partial matching:\n     *   \"0445\" vs { value: \"ALFA-BANK\", data: { \"bic\": \"044525593\" }} is a match\n     */\n    matchByFields: function(fields) {\n        return function(query, suggestions) {\n            var tokens = text_util.splitTokens(text_util.split(query));\n            var suggestionWords = [];\n\n            if (suggestions.length === 1) {\n                if (fields) {\n                    collection_util.each(fields, function(stopwords, field) {\n                        var fieldValue = object_util.getDeepValue(\n                            suggestions[0],\n                            field\n                        );\n                        var fieldWords =\n                            fieldValue &&\n                            text_util.splitTokens(\n                                text_util.split(fieldValue, stopwords)\n                            );\n\n                        if (fieldWords && fieldWords.length) {\n                            suggestionWords = suggestionWords.concat(\n                                fieldWords\n                            );\n                        }\n                    });\n                }\n\n                if (\n                    collection_util.minusWithPartialMatching(\n                        tokens,\n                        suggestionWords\n                    ).length === 0\n                ) {\n                    return 0;\n                }\n            }\n\n            return -1;\n        };\n    }\n};\n\nvar ADDRESS_STOPWORDS = [\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"/\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"-\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"/_\",\n    \"/_\",\n    \"/_\",\n    \"/_\",\n    \"/_\",\n    \"/_\",\n    \"/_\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"-\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"/\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"/\",\n    \"/\",\n    \"/\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"-\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"-\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"-\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"/\",\n    \"/\",\n    \"/\",\n    \"/\",\n    \"/\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"-\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"-\",\n    \"/\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"-\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"\",\n    \"\"\n];\n\n/**\n *  \n * @type {*[]}\n * id {String}  \n * fields {Array of Strings}\n * forBounds {Boolean}    \n * forLocations {Boolean}\n * kladrFormat {Object}\n * fiasType {String}    \n */\nvar ADDRESS_COMPONENTS = [\n    {\n        id: \"kladr_id\",\n        fields: [\"kladr_id\"],\n        forBounds: false,\n        forLocations: true\n    },\n    {\n        id: \"postal_code\",\n        fields: [\"postal_code\"],\n        forBounds: false,\n        forLocations: true\n    },\n    {\n        id: \"country_iso_code\",\n        fields: [\"country_iso_code\"],\n        forBounds: false,\n        forLocations: true\n    },\n    {\n        id: \"country\",\n        fields: [\"country\"],\n        forBounds: true,\n        forLocations: true,\n        kladrFormat: { digits: 0, zeros: 13 },\n        fiasType: \"country_iso_code\"\n    },\n    {\n        id: \"region_iso_code\",\n        fields: [\"region_iso_code\"],\n        forBounds: false,\n        forLocations: true\n    },\n    {\n        id: \"region_fias_id\",\n        fields: [\"region_fias_id\"],\n        forBounds: false,\n        forLocations: true\n    },\n    {\n        id: \"region_type_full\",\n        fields: [\"region_type_full\"],\n        forBounds: false,\n        forLocations: true,\n        kladrFormat: { digits: 2, zeros: 11 },\n        fiasType: \"region_fias_id\"\n    },\n    {\n        id: \"region\",\n        fields: [\n            \"region\",\n            \"region_type\",\n            \"region_type_full\",\n            \"region_with_type\"\n        ],\n        forBounds: true,\n        forLocations: true,\n        kladrFormat: { digits: 2, zeros: 11 },\n        fiasType: \"region_fias_id\"\n    },\n    {\n        id: \"area_fias_id\",\n        fields: [\"area_fias_id\"],\n        forBounds: false,\n        forLocations: true\n    },\n    {\n        id: \"area_type_full\",\n        fields: [\"area_type_full\"],\n        forBounds: false,\n        forLocations: true,\n        kladrFormat: { digits: 5, zeros: 8 },\n        fiasType: \"area_fias_id\"\n    },\n    {\n        id: \"area\",\n        fields: [\"area\", \"area_type\", \"area_type_full\", \"area_with_type\"],\n        forBounds: true,\n        forLocations: true,\n        kladrFormat: { digits: 5, zeros: 8 },\n        fiasType: \"area_fias_id\"\n    },\n    {\n        id: \"city_fias_id\",\n        fields: [\"city_fias_id\"],\n        forBounds: false,\n        forLocations: true\n    },\n    {\n        id: \"city_type_full\",\n        fields: [\"city_type_full\"],\n        forBounds: false,\n        forLocations: true,\n        kladrFormat: { digits: 8, zeros: 5 },\n        fiasType: \"city_fias_id\"\n    },\n    {\n        id: \"city\",\n        fields: [\"city\", \"city_type\", \"city_type_full\", \"city_with_type\"],\n        forBounds: true,\n        forLocations: true,\n        kladrFormat: { digits: 8, zeros: 5 },\n        fiasType: \"city_fias_id\"\n    },\n    {\n        id: \"city_district_fias_id\",\n        fields: [\"city_district_fias_id\"],\n        forBounds: false,\n        forLocations: true\n    },\n    {\n        id: \"city_district_type_full\",\n        fields: [\"city_district_type_full\"],\n        forBounds: false,\n        forLocations: true,\n        kladrFormat: { digits: 11, zeros: 2 },\n        fiasType: \"city_district_fias_id\"\n    },\n    {\n        id: \"city_district\",\n        fields: [\n            \"city_district\",\n            \"city_district_type\",\n            \"city_district_type_full\",\n            \"city_district_with_type\"\n        ],\n        forBounds: true,\n        forLocations: true,\n        kladrFormat: { digits: 11, zeros: 2 },\n        fiasType: \"city_district_fias_id\"\n    },\n    {\n        id: \"settlement_fias_id\",\n        fields: [\"settlement_fias_id\"],\n        forBounds: false,\n        forLocations: true\n    },\n    {\n        id: \"settlement_type_full\",\n        fields: [\"settlement_type_full\"],\n        forBounds: false,\n        forLocations: true,\n        kladrFormat: { digits: 11, zeros: 2 },\n        fiasType: \"settlement_fias_id\"\n    },\n    {\n        id: \"settlement\",\n        fields: [\n            \"settlement\",\n            \"settlement_type\",\n            \"settlement_type_full\",\n            \"settlement_with_type\"\n        ],\n        forBounds: true,\n        forLocations: true,\n        kladrFormat: { digits: 11, zeros: 2 },\n        fiasType: \"settlement_fias_id\"\n    },\n    {\n        id: \"street_fias_id\",\n        fields: [\"street_fias_id\"],\n        forBounds: false,\n        forLocations: true\n    },\n    {\n        id: \"street_type_full\",\n        fields: [\"street_type_full\"],\n        forBounds: false,\n        forLocations: true,\n        kladrFormat: { digits: 15, zeros: 2 },\n        fiasType: \"street_fias_id\"\n    },\n    {\n        id: \"street\",\n        fields: [\n            \"street\",\n            \"street_type\",\n            \"street_type_full\",\n            \"street_with_type\"\n        ],\n        forBounds: true,\n        forLocations: true,\n        kladrFormat: { digits: 15, zeros: 2 },\n        fiasType: \"street_fias_id\"\n    },\n    {\n        id: \"house\",\n        fields: [\n            \"house\",\n            \"house_type\",\n            \"house_type_full\",\n            \"block\",\n            \"block_type\"\n        ],\n        forBounds: true,\n        forLocations: true,\n        kladrFormat: { digits: 19 },\n        fiasType: \"house_fias_id\"\n    },\n    {\n        id: \"flat\",\n        fields: [\"flat\", \"flat_type\", \"flat_type_full\"],\n        forBounds: true,\n        forLocations: false,\n        kladrFormat: { digits: 19 },\n        fiasType: \"flat_fias_id\"\n    }\n];\n\nvar ADDRESS_TYPE = {\n    urlSuffix: \"address\",\n    noSuggestionsHint: \" \",\n    matchers: [\n        matchers.matchByNormalizedQuery(ADDRESS_STOPWORDS),\n        matchers.matchByWordsAddress(ADDRESS_STOPWORDS)\n    ],\n    dataComponents: ADDRESS_COMPONENTS,\n    dataComponentsById: object_util.indexObjectsById(\n        ADDRESS_COMPONENTS,\n        \"id\",\n        \"index\"\n    ),\n    unformattableTokens: ADDRESS_STOPWORDS,\n    enrichmentEnabled: true,\n    enrichmentMethod: \"suggest\",\n    enrichmentParams: {\n        count: 1,\n        locations: null,\n        locations_boost: null,\n        from_bound: null,\n        to_bound: null\n    },\n    getEnrichmentQuery: function(suggestion) {\n        return suggestion.unrestricted_value;\n    },\n    geoEnabled: true,\n    isDataComplete: function(suggestion) {\n        var fields = [this.bounds.to || \"flat\"],\n            data = suggestion.data;\n\n        return (\n            !lang_util.isPlainObject(data) ||\n            object_util.fieldsAreNotEmpty(data, fields)\n        );\n    },\n    composeValue: function(data, options) {\n        var country = data.country,\n            region =\n                data.region_with_type ||\n                collection_util\n                    .compact([data.region, data.region_type])\n                    .join(\" \") ||\n                data.region_type_full,\n            area =\n                data.area_with_type ||\n                collection_util\n                    .compact([data.area_type, data.area])\n                    .join(\" \") ||\n                data.area_type_full,\n            city =\n                data.city_with_type ||\n                collection_util\n                    .compact([data.city_type, data.city])\n                    .join(\" \") ||\n                data.city_type_full,\n            settelement =\n                data.settlement_with_type ||\n                collection_util\n                    .compact([data.settlement_type, data.settlement])\n                    .join(\" \") ||\n                data.settlement_type_full,\n            cityDistrict =\n                data.city_district_with_type ||\n                collection_util\n                    .compact([data.city_district_type, data.city_district])\n                    .join(\" \") ||\n                data.city_district_type_full,\n            street =\n                data.street_with_type ||\n                collection_util\n                    .compact([data.street_type, data.street])\n                    .join(\" \") ||\n                data.street_type_full,\n            house = collection_util\n                .compact([\n                    data.stead_type,\n                    data.stead,\n                    data.house_type,\n                    data.house,\n                    data.block_type,\n                    data.block\n                ])\n                .join(\" \"),\n            flat = collection_util\n                .compact([data.flat_type, data.flat])\n                .join(\" \"),\n            postal_box = data.postal_box && \"/ \" + data.postal_box,\n            result;\n\n        //     \n        //   ,  \n        //    \n        if (region === city) {\n            region = \"\";\n        }\n\n        //    \n        if (!(options && options.saveCityDistrict)) {\n            if (options && options.excludeCityDistrict) {\n                //    \n                cityDistrict = \"\";\n            } else if (cityDistrict && !data.city_district_fias_id) {\n                //      (   city_district_fias_id)\n                cityDistrict = \"\";\n            }\n        }\n\n        result = collection_util\n            .compact([\n                country,\n                region,\n                area,\n                city,\n                cityDistrict,\n                settelement,\n                street,\n                house,\n                flat,\n                postal_box\n            ])\n            .join(\", \");\n\n        return result;\n    },\n    formatResult: (function() {\n        var componentsUnderCityDistrict = [],\n            _underCityDistrict = false;\n\n        ADDRESS_COMPONENTS.forEach(function(component) {\n            if (_underCityDistrict)\n                componentsUnderCityDistrict.push(component.id);\n            if (component.id === \"city_district\") _underCityDistrict = true;\n        });\n\n        return function(value, currentValue, suggestion, options) {\n            var that = this,\n                district =\n                    suggestion.data && suggestion.data.city_district_with_type,\n                unformattableTokens = options && options.unformattableTokens,\n                historyValues =\n                    suggestion.data && suggestion.data.history_values,\n                tokens,\n                unusedTokens,\n                formattedHistoryValues;\n\n            //   \n            if (historyValues && historyValues.length > 0) {\n                tokens = text_util.tokenize(currentValue, unformattableTokens);\n                unusedTokens = this.type.findUnusedTokens(tokens, value);\n                formattedHistoryValues = this.type.getFormattedHistoryValues(\n                    unusedTokens,\n                    historyValues\n                );\n                if (formattedHistoryValues) {\n                    value += formattedHistoryValues;\n                }\n            }\n\n            value = that.highlightMatches(\n                value,\n                currentValue,\n                suggestion,\n                options\n            );\n            value = that.wrapFormattedValue(value, suggestion);\n\n            if (\n                district &&\n                (!that.bounds.own.length ||\n                    that.bounds.own.indexOf(\"street\") >= 0) &&\n                !lang_util.isEmptyObject(\n                    that.copyDataComponents(\n                        suggestion.data,\n                        componentsUnderCityDistrict\n                    )\n                )\n            ) {\n                value +=\n                    '<div class=\"' +\n                    that.classes.subtext +\n                    '\">' +\n                    that.highlightMatches(district, currentValue, suggestion) +\n                    \"</div>\";\n            }\n\n            return value;\n        };\n    })(),\n\n    /**\n     *     ,\n     *     \n     */\n    findUnusedTokens: function(tokens, value) {\n        var tokenIndex,\n            token,\n            unused = [];\n\n        unused = tokens.filter(function(token) {\n            return value.indexOf(token) === -1;\n        });\n\n        return unused;\n    },\n\n    /**\n     *      ,\n     *         \n     */\n    getFormattedHistoryValues: function(unusedTokens, historyValues) {\n        var tokenIndex,\n            token,\n            historyValueIndex,\n            historyValue,\n            values = [],\n            formatted = \"\";\n\n        historyValues.forEach(function(historyValue) {\n            collection_util.each(unusedTokens, function(token) {\n                if (historyValue.toLowerCase().indexOf(token) >= 0) {\n                    values.push(historyValue);\n                    return false;\n                }\n            });\n        });\n\n        if (values.length > 0) {\n            formatted = \" (. \" + values.join(\", \") + \")\";\n        }\n\n        return formatted;\n    },\n\n    /**\n     * @param instance\n     * @param options\n     * @param options.suggestion\n     * @param options.hasSameValues\n     * @param options.hasBeenEnreached\n     */\n    getSuggestionValue: function(instance, options) {\n        var formattedValue = null;\n\n        if (options.hasSameValues) {\n            if (instance.options.restrict_value) {\n                // Can not use unrestricted address,\n                // because some components (from constraints) must be omitted\n                formattedValue = this.getValueWithinConstraints(\n                    instance,\n                    options.suggestion\n                );\n            } else if (instance.bounds.own.length) {\n                // Can not use unrestricted address,\n                // because only components from bounds must be included\n                formattedValue = this.getValueWithinBounds(\n                    instance,\n                    options.suggestion\n                );\n            } else {\n                // Can use full unrestricted address\n                formattedValue = options.suggestion.unrestricted_value;\n            }\n        } else if (options.hasBeenEnriched) {\n            if (instance.options.restrict_value) {\n                formattedValue = this.getValueWithinConstraints(\n                    instance,\n                    options.suggestion,\n                    { excludeCityDistrict: true }\n                );\n            }\n        }\n\n        return formattedValue;\n    },\n    /*\n     * Compose suggestion value with respect to constraints\n     */\n    getValueWithinConstraints: function(instance, suggestion, options) {\n        return this.composeValue(\n            instance.getUnrestrictedData(suggestion.data),\n            options\n        );\n    },\n    /*\n     * Compose suggestion value with respect to bounds\n     */\n    getValueWithinBounds: function(instance, suggestion, options) {\n        //      city_district_fias_id\n        var data = instance.copyDataComponents(\n            suggestion.data,\n            instance.bounds.own.concat([\"city_district_fias_id\"])\n        );\n\n        return this.composeValue(data, options);\n    }\n};\n\n/**\n *  \n * @type {*[]}\n * id {String}  \n * fields {Array of Strings}\n * forBounds {Boolean}    \n * forLocations {Boolean}\n * kladrFormat {Object}\n * fiasType {String}    \n */\nvar FIAS_COMPONENTS = [\n    {\n        id: \"kladr_id\",\n        fields: [\"kladr_id\"],\n        forBounds: false,\n        forLocations: true\n    },\n    {\n        id: \"region_fias_id\",\n        fields: [\"region_fias_id\"],\n        forBounds: false,\n        forLocations: true\n    },\n    {\n        id: \"region_type_full\",\n        fields: [\"region_type_full\"],\n        forBounds: false,\n        forLocations: true,\n        kladrFormat: { digits: 2, zeros: 11 },\n        fiasType: \"region_fias_id\"\n    },\n    {\n        id: \"region\",\n        fields: [\n            \"region\",\n            \"region_type\",\n            \"region_type_full\",\n            \"region_with_type\"\n        ],\n        forBounds: true,\n        forLocations: true,\n        kladrFormat: { digits: 2, zeros: 11 },\n        fiasType: \"region_fias_id\"\n    },\n    {\n        id: \"area_fias_id\",\n        fields: [\"area_fias_id\"],\n        forBounds: false,\n        forLocations: true\n    },\n    {\n        id: \"area_type_full\",\n        fields: [\"area_type_full\"],\n        forBounds: false,\n        forLocations: true,\n        kladrFormat: { digits: 5, zeros: 8 },\n        fiasType: \"area_fias_id\"\n    },\n    {\n        id: \"area\",\n        fields: [\"area\", \"area_type\", \"area_type_full\", \"area_with_type\"],\n        forBounds: true,\n        forLocations: true,\n        kladrFormat: { digits: 5, zeros: 8 },\n        fiasType: \"area_fias_id\"\n    },\n    {\n        id: \"city_fias_id\",\n        fields: [\"city_fias_id\"],\n        forBounds: false,\n        forLocations: true\n    },\n    {\n        id: \"city_type_full\",\n        fields: [\"city_type_full\"],\n        forBounds: false,\n        forLocations: true,\n        kladrFormat: { digits: 8, zeros: 5 },\n        fiasType: \"city_fias_id\"\n    },\n    {\n        id: \"city\",\n        fields: [\"city\", \"city_type\", \"city_type_full\", \"city_with_type\"],\n        forBounds: true,\n        forLocations: true,\n        kladrFormat: { digits: 8, zeros: 5 },\n        fiasType: \"city_fias_id\"\n    },\n    {\n        id: \"city_district_fias_id\",\n        fields: [\"city_district_fias_id\"],\n        forBounds: false,\n        forLocations: true\n    },\n    {\n        id: \"city_district_type_full\",\n        fields: [\"city_district_type_full\"],\n        forBounds: false,\n        forLocations: true,\n        kladrFormat: { digits: 11, zeros: 2 },\n        fiasType: \"city_district_fias_id\"\n    },\n    {\n        id: \"city_district\",\n        fields: [\n            \"city_district\",\n            \"city_district_type\",\n            \"city_district_type_full\",\n            \"city_district_with_type\"\n        ],\n        forBounds: true,\n        forLocations: true,\n        kladrFormat: { digits: 11, zeros: 2 },\n        fiasType: \"city_district_fias_id\"\n    },\n    {\n        id: \"settlement_fias_id\",\n        fields: [\"settlement_fias_id\"],\n        forBounds: false,\n        forLocations: true\n    },\n    {\n        id: \"settlement_type_full\",\n        fields: [\"settlement_type_full\"],\n        forBounds: false,\n        forLocations: true,\n        kladrFormat: { digits: 11, zeros: 2 },\n        fiasType: \"settlement_fias_id\"\n    },\n    {\n        id: \"settlement\",\n        fields: [\n            \"settlement\",\n            \"settlement_type\",\n            \"settlement_type_full\",\n            \"settlement_with_type\"\n        ],\n        forBounds: true,\n        forLocations: true,\n        kladrFormat: { digits: 11, zeros: 2 },\n        fiasType: \"settlement_fias_id\"\n    },\n    {\n        id: \"planning_structure_fias_id\",\n        fields: [\"planning_structure_fias_id\"],\n        forBounds: false,\n        forLocations: true\n    },\n    {\n        id: \"planning_structure_type_full\",\n        fields: [\"planning_structure_type_full\"],\n        forBounds: false,\n        forLocations: true,\n        kladrFormat: { digits: 15, zeros: 2 },\n        fiasType: \"planning_structure_fias_id\"\n    },\n    {\n        id: \"planning_structure\",\n        fields: [\n            \"planning_structure\",\n            \"planning_structure_type\",\n            \"planning_structure_type_full\",\n            \"planning_structure_with_type\"\n        ],\n        forBounds: true,\n        forLocations: true,\n        kladrFormat: { digits: 15, zeros: 2 },\n        fiasType: \"planning_structure_fias_id\"\n    },\n    {\n        id: \"street_fias_id\",\n        fields: [\"street_fias_id\"],\n        forBounds: false,\n        forLocations: true\n    },\n    {\n        id: \"street_type_full\",\n        fields: [\"street_type_full\"],\n        forBounds: false,\n        forLocations: true,\n        kladrFormat: { digits: 15, zeros: 2 },\n        fiasType: \"street_fias_id\"\n    },\n    {\n        id: \"street\",\n        fields: [\n            \"street\",\n            \"street_type\",\n            \"street_type_full\",\n            \"street_with_type\"\n        ],\n        forBounds: true,\n        forLocations: true,\n        kladrFormat: { digits: 15, zeros: 2 },\n        fiasType: \"street_fias_id\"\n    },\n    {\n        id: \"house\",\n        fields: [\"house\", \"house_type\", \"block\", \"building_type\", \"building\"],\n        forBounds: true,\n        forLocations: false,\n        kladrFormat: { digits: 19 }\n    }\n];\n\nvar FIAS_TYPE = {\n    urlSuffix: \"fias\",\n    noSuggestionsHint: \" \",\n    matchers: [\n        matchers.matchByNormalizedQuery(ADDRESS_STOPWORDS),\n        matchers.matchByWordsAddress(ADDRESS_STOPWORDS)\n    ],\n    dataComponents: FIAS_COMPONENTS,\n    dataComponentsById: object_util.indexObjectsById(\n        FIAS_COMPONENTS,\n        \"id\",\n        \"index\"\n    ),\n    unformattableTokens: ADDRESS_STOPWORDS,\n    isDataComplete: function(suggestion) {\n        var fields = [this.bounds.to || \"house\"],\n            data = suggestion.data;\n\n        return (\n            !lang_util.isPlainObject(data) ||\n            object_util.fieldsAreNotEmpty(data, fields)\n        );\n    },\n    composeValue: function(data, options) {\n        var country = data.country,\n            region =\n                data.region_with_type ||\n                collection_util\n                    .compact([data.region, data.region_type])\n                    .join(\" \") ||\n                data.region_type_full,\n            area =\n                data.area_with_type ||\n                collection_util\n                    .compact([data.area_type, data.area])\n                    .join(\" \") ||\n                data.area_type_full,\n            city =\n                data.city_with_type ||\n                collection_util\n                    .compact([data.city_type, data.city])\n                    .join(\" \") ||\n                data.city_type_full,\n            settelement =\n                data.settlement_with_type ||\n                collection_util\n                    .compact([data.settlement_type, data.settlement])\n                    .join(\" \") ||\n                data.settlement_type_full,\n            cityDistrict =\n                data.city_district_with_type ||\n                collection_util\n                    .compact([data.city_district_type, data.city_district])\n                    .join(\" \") ||\n                data.city_district_type_full,\n            planning_structure =\n                data.planning_structure_with_type ||\n                collection_util\n                    .compact([\n                        data.planning_structure_type,\n                        data.planning_structure\n                    ])\n                    .join(\" \") ||\n                data.planning_structure_type_full,\n            street =\n                data.street_with_type ||\n                collection_util\n                    .compact([data.street_type, data.street])\n                    .join(\" \") ||\n                data.street_type_full,\n            house = collection_util\n                .compact([\n                    data.house_type,\n                    data.house,\n                    data.block_type,\n                    data.block\n                ])\n                .join(\" \"),\n            flat = collection_util\n                .compact([data.flat_type, data.flat])\n                .join(\" \"),\n            postal_box = data.postal_box && \"/ \" + data.postal_box,\n            result;\n\n        //     \n        //   ,  \n        //    \n        if (region === city) {\n            region = \"\";\n        }\n\n        //    \n        if (!(options && options.saveCityDistrict)) {\n            if (options && options.excludeCityDistrict) {\n                //    \n                cityDistrict = \"\";\n            } else if (cityDistrict && !data.city_district_fias_id) {\n                //      (   city_district_fias_id)\n                cityDistrict = \"\";\n            }\n        }\n\n        result = collection_util\n            .compact([\n                country,\n                region,\n                area,\n                city,\n                cityDistrict,\n                settelement,\n                planning_structure,\n                street,\n                house,\n                flat,\n                postal_box\n            ])\n            .join(\", \");\n\n        return result;\n    },\n    formatResult: (function() {\n        return function(value, currentValue, suggestion, options) {\n            var that = this;\n\n            value = that.highlightMatches(\n                value,\n                currentValue,\n                suggestion,\n                options\n            );\n            value = that.wrapFormattedValue(value, suggestion);\n            return value;\n        };\n    })(),\n\n    getSuggestionValue: ADDRESS_TYPE.getSuggestionValue,\n    getValueWithinConstraints: ADDRESS_TYPE.getValueWithinConstraints,\n    getValueWithinBounds: ADDRESS_TYPE.getValueWithinBounds\n};\n\nfunction valueStartsWith(suggestion, field) {\n    var fieldValue = suggestion.data && suggestion.data[field];\n\n    return (\n        fieldValue &&\n        new RegExp(\n            \"^\" +\n                text_util.escapeRegExChars(fieldValue) +\n                \"([\" +\n                WORD_DELIMITERS +\n                \"]|$)\",\n            \"i\"\n        ).test(suggestion.value)\n    );\n}\n\nvar NAME_TYPE = {\n    urlSuffix: \"fio\",\n    noSuggestionsHint: false,\n    matchers: [matchers.matchByNormalizedQuery(), matchers.matchByWords()],\n    // names for labels, describing which fields are displayed\n    fieldNames: {\n        surname: \"\",\n        name: \"\",\n        patronymic: \"\"\n    },\n    isDataComplete: function(suggestion) {\n        var that = this,\n            params = that.options.params,\n            data = suggestion.data,\n            fields;\n\n        if (lang_util.isFunction(params)) {\n            params = params.call(that.element, suggestion.value);\n        }\n        if (params && params.parts) {\n            fields = params.parts.map(function(part) {\n                return part.toLowerCase();\n            });\n        } else {\n            // when NAME is first, patronymic is mot mandatory\n            fields = [\"surname\", \"name\"];\n            // when SURNAME is first, it is\n            if (valueStartsWith(suggestion, \"surname\")) {\n                fields.push(\"patronymic\");\n            }\n        }\n        return object_util.fieldsAreNotEmpty(data, fields);\n    },\n    composeValue: function(data) {\n        return collection_util\n            .compact([data.surname, data.name, data.patronymic])\n            .join(\" \");\n    }\n};\n\nvar innPartsLengths = {\n    LEGAL: [2, 2, 5, 1],\n    INDIVIDUAL: [2, 2, 6, 2]\n};\n\nfunction chooseFormattedField(formattedMain, formattedAlt) {\n    var rHasMatch = /<strong>/;\n    return rHasMatch.test(formattedAlt) && !rHasMatch.test(formattedMain)\n        ? formattedAlt\n        : formattedMain;\n}\n\nfunction formattedField(main, alt, currentValue, suggestion, options) {\n    var that = this,\n        formattedMain = that.highlightMatches(\n            main,\n            currentValue,\n            suggestion,\n            options\n        ),\n        formattedAlt = that.highlightMatches(\n            alt,\n            currentValue,\n            suggestion,\n            options\n        );\n\n    return chooseFormattedField(formattedMain, formattedAlt);\n}\n\nvar PARTY_TYPE = {\n    urlSuffix: \"party\",\n    noSuggestionsHint: \" \",\n    matchers: [\n        matchers.matchByFields(\n            // These fields of suggestion's `data` used by by-words matcher\n            {\n                value: null,\n                \"data.address.value\": ADDRESS_STOPWORDS,\n                \"data.inn\": null,\n                \"data.ogrn\": null\n            }\n        )\n    ],\n    dataComponents: ADDRESS_COMPONENTS,\n    enrichmentEnabled: true,\n    enrichmentMethod: \"findById\",\n    enrichmentParams: {\n        count: 1,\n        locations_boost: null\n    },\n    getEnrichmentQuery: function(suggestion) {\n        return suggestion.data.hid;\n    },\n    geoEnabled: true,\n    formatResult: function(value, currentValue, suggestion, options) {\n        var that = this,\n            formattedInn = that.type.formatResultInn.call(\n                that,\n                suggestion,\n                currentValue\n            ),\n            formatterOGRN = that.highlightMatches(\n                object_util.getDeepValue(suggestion.data, \"ogrn\"),\n                currentValue,\n                suggestion\n            ),\n            formattedInnOGRN = chooseFormattedField(\n                formattedInn,\n                formatterOGRN\n            ),\n            formattedFIO = that.highlightMatches(\n                object_util.getDeepValue(suggestion.data, \"management.name\"),\n                currentValue,\n                suggestion\n            ),\n            address =\n                object_util.getDeepValue(suggestion.data, \"address.value\") ||\n                \"\";\n\n        if (that.isMobile) {\n            (options || (options = {})).maxLength = 50;\n        }\n\n        value = formattedField.call(\n            that,\n            value,\n            object_util.getDeepValue(suggestion.data, \"name.latin\"),\n            currentValue,\n            suggestion,\n            options\n        );\n        value = that.wrapFormattedValue(value, suggestion);\n\n        if (address) {\n            address = address.replace(/^(\\d{6}|),\\s+/i, \"\");\n            if (that.isMobile) {\n                // keep only two first words\n                address = address.replace(\n                    new RegExp(\n                        \"^([^\" +\n                            WORD_DELIMITERS +\n                            \"]+[\" +\n                            WORD_DELIMITERS +\n                            \"]+[^\" +\n                            WORD_DELIMITERS +\n                            \"]+).*\"\n                    ),\n                    \"$1\"\n                );\n            } else {\n                address = that.highlightMatches(\n                    address,\n                    currentValue,\n                    suggestion,\n                    {\n                        unformattableTokens: ADDRESS_STOPWORDS\n                    }\n                );\n            }\n        }\n\n        if (formattedInnOGRN || address || formattedFIO) {\n            value +=\n                '<div class=\"' +\n                that.classes.subtext +\n                '\">' +\n                '<span class=\"' +\n                that.classes.subtext_inline +\n                '\">' +\n                (formattedInnOGRN || \"\") +\n                \"</span>\" +\n                (chooseFormattedField(address, formattedFIO) || \"\") +\n                \"</div>\";\n        }\n        return value;\n    },\n    formatResultInn: function(suggestion, currentValue) {\n        var that = this,\n            inn = suggestion.data && suggestion.data.inn,\n            innPartsLength =\n                innPartsLengths[suggestion.data && suggestion.data.type],\n            innParts,\n            formattedInn,\n            rDigit = /\\d/;\n\n        if (inn) {\n            formattedInn = that.highlightMatches(inn, currentValue, suggestion);\n            if (innPartsLength) {\n                formattedInn = formattedInn.split(\"\");\n                innParts = innPartsLength.map(function(partLength) {\n                    var formattedPart = \"\",\n                        ch;\n\n                    while (partLength && (ch = formattedInn.shift())) {\n                        formattedPart += ch;\n                        if (rDigit.test(ch)) partLength--;\n                    }\n\n                    return formattedPart;\n                });\n                formattedInn =\n                    innParts.join(\n                        '<span class=\"' +\n                            that.classes.subtext_delimiter +\n                            '\"></span>'\n                    ) + formattedInn.join(\"\");\n            }\n\n            return formattedInn;\n        }\n    }\n};\n\nvar EMAIL_TYPE = {\n    urlSuffix: \"email\",\n    noSuggestionsHint: false,\n    matchers: [matchers.matchByNormalizedQuery()],\n    isQueryRequestable: function(query) {\n        return this.options.suggest_local || query.indexOf(\"@\") >= 0;\n    }\n};\n\nvar BANK_TYPE = {\n    urlSuffix: \"bank\",\n    noSuggestionsHint: \" \",\n    matchers: [\n        matchers.matchByFields(\n            // These fields of suggestion's `data` used by by-words matcher\n            {\n                value: null,\n                \"data.bic\": null,\n                \"data.swift\": null,\n            }\n        ),\n    ],\n    dataComponents: ADDRESS_COMPONENTS,\n    enrichmentEnabled: true,\n    enrichmentMethod: \"findById\",\n    enrichmentParams: {\n        count: 1,\n    },\n    getEnrichmentQuery: function(suggestion) {\n        return suggestion.data.bic;\n    },\n    geoEnabled: true,\n    formatResult: function(value, currentValue, suggestion, options) {\n        var that = this,\n            formattedBIC = that.highlightMatches(\n                object_util.getDeepValue(suggestion.data, \"bic\"),\n                currentValue,\n                suggestion\n            ),\n            address =\n                object_util.getDeepValue(suggestion.data, \"address.value\") ||\n                \"\";\n\n        value = that.highlightMatches(value, currentValue, suggestion, options);\n        value = that.wrapFormattedValue(value, suggestion);\n\n        if (address) {\n            address = address.replace(/^\\d{6}( )?, /i, \"\");\n            if (that.isMobile) {\n                // keep only two first words\n                address = address.replace(\n                    new RegExp(\n                        \"^([^\" +\n                            WORD_DELIMITERS +\n                            \"]+[\" +\n                            WORD_DELIMITERS +\n                            \"]+[^\" +\n                            WORD_DELIMITERS +\n                            \"]+).*\"\n                    ),\n                    \"$1\"\n                );\n            } else {\n                address = that.highlightMatches(\n                    address,\n                    currentValue,\n                    suggestion,\n                    {\n                        unformattableTokens: ADDRESS_STOPWORDS,\n                    }\n                );\n            }\n        }\n\n        if (formattedBIC || address) {\n            value +=\n                '<div class=\"' +\n                that.classes.subtext +\n                '\">' +\n                '<span class=\"' +\n                that.classes.subtext_inline +\n                '\">' +\n                formattedBIC +\n                \"</span>\" +\n                address +\n                \"</div>\";\n        }\n        return value;\n    },\n    formatSelected: function(suggestion) {\n        return (\n            object_util.getDeepValue(suggestion, \"data.name.payment\") || null\n        );\n    },\n};\n\nfunction Outward(name) {\n    this.urlSuffix = name.toLowerCase();\n    this.noSuggestionsHint = \" \";\n    this.matchers = [\n        matchers.matchByNormalizedQuery(),\n        matchers.matchByWords()\n    ];\n}\n\n/**\n * Type is a bundle of properties:\n * - urlSuffix Mandatory. String\n * - matchers Mandatory. Array of functions (with optional data bound as a context) that find appropriate suggestion to select\n * - `fieldNames` Map fields of suggestion.data to their displayable names\n * - `unformattableTokens` Array of strings which should not be highlighted\n * - `dataComponents` Array of 'bound's can be set as `bounds` option. Order is important.\n *\n * flags:\n * - `alwaysContinueSelecting` Forbids to hide dropdown after selecting\n * - `geoEnabled` Makes to detect client's location for passing it to all requests\n * - `enrichmentEnabled` Makes to send additional request when a suggestion is selected\n *\n * and methods:\n * - `isDataComplete` Checks if suggestion.data can be operated as full data of it's type\n * - `composeValue` returns string value based on suggestion.data\n * - `formatResult` returns html of a suggestion. Overrides default method\n * - `formatResultInn` returns html of suggestion.data.inn\n * - `isQueryRequestable` checks if query is appropriated for requesting server\n * - `formatSelected` returns string to be inserted in textbox\n */\n\nvar types = {\n    NAME: NAME_TYPE,\n    ADDRESS: ADDRESS_TYPE,\n    FIAS: FIAS_TYPE,\n    PARTY: PARTY_TYPE,\n    EMAIL: EMAIL_TYPE,\n    BANK: BANK_TYPE\n};\n\ntypes.get = function(type) {\n    if (types.hasOwnProperty(type)) {\n        return types[type];\n    } else {\n        return new Outward(type);\n    }\n};\n\njqapi.extend(DEFAULT_OPTIONS, {\n    suggest_local: true\n});\n\nvar notificator = {\n    chains: {},\n\n    on: function(name, method) {\n        this.get(name).push(method);\n        return this;\n    },\n\n    get: function(name) {\n        var chains = this.chains;\n        return chains[name] || (chains[name] = []);\n    }\n};\n\nvar serviceMethods = {\n    suggest: {\n        defaultParams: {\n            type: utils.getDefaultType(),\n            dataType: \"json\",\n            contentType: utils.getDefaultContentType()\n        },\n        addTypeInUrl: true\n    },\n    \"iplocate/address\": {\n        defaultParams: {\n            type: \"GET\",\n            dataType: \"json\"\n        },\n        addTypeInUrl: false\n    },\n    status: {\n        defaultParams: {\n            type: \"GET\",\n            dataType: \"json\"\n        },\n        addTypeInUrl: true\n    },\n    findById: {\n        defaultParams: {\n            type: utils.getDefaultType(),\n            dataType: \"json\",\n            contentType: utils.getDefaultContentType()\n        },\n        addTypeInUrl: true\n    }\n};\n\nvar requestModes = {\n    suggest: {\n        method: \"suggest\",\n        userSelect: true,\n        updateValue: true,\n        enrichmentEnabled: true\n    },\n    findById: {\n        method: \"findById\",\n        userSelect: false,\n        updateValue: false,\n        enrichmentEnabled: false\n    }\n};\n\nfunction Suggestions(el, options) {\n    var that = this;\n\n    // Shared variables:\n    that.element = el;\n    that.el = $(el);\n    that.suggestions = [];\n    that.badQueries = [];\n    that.selectedIndex = -1;\n    that.currentValue = that.element.value;\n    that.intervalId = 0;\n    that.cachedResponse = {};\n    that.enrichmentCache = {};\n    that.currentRequest = null;\n    that.inputPhase = $.Deferred();\n    that.fetchPhase = $.Deferred();\n    that.enrichPhase = $.Deferred();\n    that.onChangeTimeout = null;\n    that.triggering = {};\n    that.$wrapper = null;\n    that.options = $.extend({}, DEFAULT_OPTIONS, options);\n    that.classes = CLASSES;\n    that.disabled = false;\n    that.selection = null;\n    that.$viewport = $(window);\n    that.$body = $(document.body);\n    that.type = null;\n    that.status = {};\n\n    that.setupElement();\n\n    that.initializer = $.Deferred();\n\n    if (that.el.is(\":visible\")) {\n        that.initializer.resolve();\n    } else {\n        that.deferInitialization();\n    }\n\n    that.initializer.done($.proxy(that.initialize, that));\n}\n\nSuggestions.prototype = {\n    // Creation and destruction\n\n    initialize: function() {\n        var that = this;\n        that.uniqueId = utils.uniqueId(\"i\");\n        that.createWrapper();\n        that.notify(\"initialize\");\n        that.bindWindowEvents();\n        that.setOptions();\n        that.inferIsMobile();\n        that.notify(\"ready\");\n    },\n\n    /**\n     * Initialize when element is firstly interacted\n     */\n    deferInitialization: function() {\n        var that = this,\n            events = \"mouseover focus keydown\",\n            timer,\n            callback = function() {\n                that.initializer.resolve();\n                that.enable();\n            };\n\n        that.initializer.always(function() {\n            that.el.off(events, callback);\n            clearInterval(timer);\n        });\n\n        that.disabled = true;\n        that.el.on(events, callback);\n        timer = setInterval(function() {\n            if (that.el.is(\":visible\")) {\n                callback();\n            }\n        }, that.options.initializeInterval);\n    },\n\n    isInitialized: function() {\n        return this.initializer.state() === \"resolved\";\n    },\n\n    dispose: function() {\n        var that = this;\n        that.initializer.reject();\n        that.notify(\"dispose\");\n        that.el.removeData(DATA_ATTR_KEY).removeClass(\"suggestions-input\");\n        that.unbindWindowEvents();\n        that.removeWrapper();\n        that.el.trigger(\"suggestions-dispose\");\n    },\n\n    notify: function(chainName) {\n        var that = this,\n            args = utils.slice(arguments, 1);\n\n        return $.map(notificator.get(chainName), function(method) {\n            return method.apply(that, args);\n        });\n    },\n\n    createWrapper: function() {\n        var that = this;\n\n        that.$wrapper = $('<div class=\"suggestions-wrapper\"/>');\n        that.el.after(that.$wrapper);\n\n        that.$wrapper.on(\n            \"mousedown\" + EVENT_NS,\n            $.proxy(that.onMousedown, that)\n        );\n    },\n\n    removeWrapper: function() {\n        var that = this;\n\n        if (that.$wrapper) {\n            that.$wrapper.remove();\n        }\n        $(that.options.$helpers).off(EVENT_NS);\n    },\n\n    /** This whole handler is needed to prevent blur event on textbox\n     * when suggestion is clicked (blur leads to suggestions hide, so we need to prevent it).\n     * See https://github.com/jquery/jquery-ui/blob/master/ui/autocomplete.js for details\n     */\n    onMousedown: function(e) {\n        var that = this;\n\n        // prevent moving focus out of the text field\n        e.preventDefault();\n\n        // IE doesn't prevent moving focus even with e.preventDefault()\n        // so we set a flag to know when we should ignore the blur event\n        that.cancelBlur = true;\n        utils.delay(function() {\n            delete that.cancelBlur;\n        });\n\n        // clicking on the scrollbar causes focus to shift to the body\n        // but we can't detect a mouseup or a click immediately afterward\n        // so we have to track the next mousedown and close the menu if\n        // the user clicks somewhere outside of the autocomplete\n        if ($(e.target).closest(\".ui-menu-item\").length == 0) {\n            utils.delay(function() {\n                $(document).one(\"mousedown\", function(e) {\n                    var $elements = that.el\n                        .add(that.$wrapper)\n                        .add(that.options.$helpers);\n\n                    if (that.options.floating) {\n                        $elements = $elements.add(that.$container);\n                    }\n\n                    $elements = $elements.filter(function() {\n                        return this === e.target || $.contains(this, e.target);\n                    });\n\n                    if (!$elements.length) {\n                        that.hide();\n                    }\n                });\n            });\n        }\n    },\n\n    bindWindowEvents: function() {\n        var handler = $.proxy(this.inferIsMobile, this);\n        this.$viewport.on(\"resize\" + EVENT_NS + this.uniqueId, handler);\n    },\n\n    unbindWindowEvents: function() {\n        this.$viewport.off(\"resize\" + EVENT_NS + this.uniqueId);\n    },\n\n    scrollToTop: function() {\n        var that = this,\n            scrollTarget = that.options.scrollOnFocus;\n\n        if (scrollTarget === true) {\n            scrollTarget = that.el;\n        }\n        if (scrollTarget instanceof $ && scrollTarget.length > 0) {\n            $(\"body,html\").animate(\n                {\n                    scrollTop: scrollTarget.offset().top\n                },\n                \"fast\"\n            );\n        }\n    },\n\n    // Configuration methods\n\n    setOptions: function(suppliedOptions) {\n        var that = this;\n\n        $.extend(that.options, suppliedOptions);\n\n        that[\"type\"] = types.get(that.options[\"type\"]);\n\n        // Check mandatory options\n        $.each(\n            {\n                requestMode: requestModes\n            },\n            function(option, available) {\n                that[option] = available[that.options[option]];\n                if (!that[option]) {\n                    that.disable();\n                    throw \"`\" +\n                        option +\n                        \"` option is incorrect! Must be one of: \" +\n                        $.map(available, function(value, name) {\n                            return '\"' + name + '\"';\n                        }).join(\", \");\n                }\n            }\n        );\n\n        $(that.options.$helpers)\n            .off(EVENT_NS)\n            .on(\"mousedown\" + EVENT_NS, $.proxy(that.onMousedown, that));\n\n        if (that.isInitialized()) {\n            that.notify(\"setOptions\");\n        }\n    },\n\n    // Common public methods\n\n    inferIsMobile: function() {\n        this.isMobile = this.$viewport.width() <= this.options.mobileWidth;\n    },\n\n    clearCache: function() {\n        this.cachedResponse = {};\n        this.enrichmentCache = {};\n        this.badQueries = [];\n    },\n\n    clear: function() {\n        var that = this,\n            currentSelection = that.selection;\n\n        if (that.isInitialized()) {\n            that.clearCache();\n            that.currentValue = \"\";\n            that.selection = null;\n            that.hide();\n            that.suggestions = [];\n            that.el.val(\"\");\n            that.el.trigger(\"suggestions-clear\");\n            that.notify(\"clear\");\n            that.trigger(\"InvalidateSelection\", currentSelection);\n        }\n    },\n\n    disable: function() {\n        var that = this;\n\n        that.disabled = true;\n        that.abortRequest();\n        if (that.visible) {\n            that.hide();\n        }\n    },\n\n    enable: function() {\n        this.disabled = false;\n    },\n\n    isUnavailable: function() {\n        return this.disabled;\n    },\n\n    update: function() {\n        var that = this,\n            query = that.el.val();\n\n        if (that.isInitialized()) {\n            that.currentValue = query;\n            if (that.isQueryRequestable(query)) {\n                that.updateSuggestions(query);\n            } else {\n                that.hide();\n            }\n        }\n    },\n\n    setSuggestion: function(suggestion) {\n        var that = this,\n            data,\n            value;\n\n        if ($.isPlainObject(suggestion) && $.isPlainObject(suggestion.data)) {\n            suggestion = $.extend(true, {}, suggestion);\n\n            if (\n                that.isUnavailable() &&\n                that.initializer &&\n                that.initializer.state() === \"pending\"\n            ) {\n                that.initializer.resolve();\n                that.enable();\n            }\n\n            if (that.bounds.own.length) {\n                that.checkValueBounds(suggestion);\n                data = that.copyDataComponents(\n                    suggestion.data,\n                    that.bounds.all\n                );\n                if (suggestion.data.kladr_id) {\n                    data.kladr_id = that.getBoundedKladrId(\n                        suggestion.data.kladr_id,\n                        that.bounds.all\n                    );\n                }\n                suggestion.data = data;\n            }\n\n            that.selection = suggestion;\n\n            // `that.suggestions` required by `that.getSuggestionValue` and must be set before\n            that.suggestions = [suggestion];\n            value = that.getSuggestionValue(suggestion) || \"\";\n            that.currentValue = value;\n            that.el.val(value);\n            that.abortRequest();\n            that.el.trigger(\"suggestions-set\");\n        }\n    },\n\n    /**\n     * Fetch full object for current INPUT's value\n     * if no suitable object found, clean input element\n     */\n    fixData: function() {\n        var that = this,\n            fullQuery = that.extendedCurrentValue(),\n            currentValue = that.el.val(),\n            resolver = $.Deferred();\n\n        resolver\n            .done(function(suggestion) {\n                that.selectSuggestion(suggestion, 0, currentValue, {\n                    hasBeenEnriched: true\n                });\n                that.el.trigger(\"suggestions-fixdata\", suggestion);\n            })\n            .fail(function() {\n                that.selection = null;\n                that.el.trigger(\"suggestions-fixdata\");\n            });\n\n        if (that.isQueryRequestable(fullQuery)) {\n            that.currentValue = fullQuery;\n            that.getSuggestions(fullQuery, {\n                count: 1,\n                from_bound: null,\n                to_bound: null\n            })\n                .done(function(suggestions) {\n                    // data fetched\n                    var suggestion = suggestions[0];\n                    if (suggestion) {\n                        resolver.resolve(suggestion);\n                    } else {\n                        resolver.reject();\n                    }\n                })\n                .fail(function() {\n                    // no data fetched\n                    resolver.reject();\n                });\n        } else {\n            resolver.reject();\n        }\n    },\n\n    // Querying related methods\n\n    /**\n     * Looks up parent instances\n     * @returns {String} current value prepended by parents' values\n     */\n    extendedCurrentValue: function() {\n        var that = this,\n            parentInstance = that.getParentInstance(),\n            parentValue =\n                parentInstance && parentInstance.extendedCurrentValue(),\n            currentValue = $.trim(that.el.val());\n\n        return utils.compact([parentValue, currentValue]).join(\" \");\n    },\n\n    getAjaxParams: function(method, custom) {\n        var that = this,\n            token = $.trim(that.options.token),\n            partner = $.trim(that.options.partner),\n            serviceUrl = that.options.serviceUrl,\n            url = that.options.url,\n            serviceMethod = serviceMethods[method],\n            params = $.extend(\n                {\n                    timeout: that.options.timeout\n                },\n                serviceMethod.defaultParams\n            ),\n            headers = {};\n\n        if (url) {\n            serviceUrl = url;\n        } else {\n            if (!/\\/$/.test(serviceUrl)) {\n                serviceUrl += \"/\";\n            }\n            serviceUrl += method;\n            if (serviceMethod.addTypeInUrl) {\n                serviceUrl += \"/\" + that.type.urlSuffix;\n            }\n        }\n\n        serviceUrl = utils.fixURLProtocol(serviceUrl);\n\n        if ($.support.cors) {\n            // for XMLHttpRequest put token in header\n            if (token) {\n                headers[\"Authorization\"] = \"Token \" + token;\n            }\n            if (partner) {\n                headers[\"X-Partner\"] = partner;\n            }\n            headers[\"X-Version\"] = Suggestions.version;\n            if (!params.headers) {\n                params.headers = {};\n            }\n            if (!params.xhrFields) {\n                params.xhrFields = {};\n            }\n            $.extend(params.headers, that.options.headers, headers);\n            // server sets Access-Control-Allow-Origin: *\n            // which requires no credentials\n            params.xhrFields.withCredentials = false;\n        } else {\n            // for XDomainRequest put token into URL\n            if (token) {\n                headers[\"token\"] = token;\n            }\n            if (partner) {\n                headers[\"partner\"] = partner;\n            }\n            headers[\"version\"] = Suggestions.version;\n            serviceUrl = utils.addUrlParams(serviceUrl, headers);\n        }\n\n        params.url = serviceUrl;\n\n        return $.extend(params, custom);\n    },\n\n    isQueryRequestable: function(query) {\n        var that = this,\n            result;\n\n        result = query.length >= that.options.minChars;\n\n        if (result && that.type.isQueryRequestable) {\n            result = that.type.isQueryRequestable.call(that, query);\n        }\n\n        return result;\n    },\n\n    constructRequestParams: function(query, customParams) {\n        var that = this,\n            options = that.options,\n            params = $.isFunction(options.params)\n                ? options.params.call(that.element, query)\n                : $.extend({}, options.params);\n\n        if (that.type.constructRequestParams) {\n            $.extend(params, that.type.constructRequestParams.call(that));\n        }\n        $.each(that.notify(\"requestParams\"), function(i, hookParams) {\n            $.extend(params, hookParams);\n        });\n        params[options.paramName] = query;\n        if ($.isNumeric(options.count) && options.count > 0) {\n            params.count = options.count;\n        }\n        if (options.language) {\n            params.language = options.language;\n        }\n\n        return $.extend(params, customParams);\n    },\n\n    updateSuggestions: function(query) {\n        var that = this;\n\n        that.fetchPhase = that\n            .getSuggestions(query)\n            .done(function(suggestions) {\n                that.assignSuggestions(suggestions, query);\n            });\n    },\n\n    /**\n     * Get suggestions from cache or from server\n     * @param {String} query\n     * @param {Object} customParams parameters specified here will be passed to request body\n     * @param {Object} requestOptions\n     * @param {Boolean} [requestOptions.noCallbacks]  flag, request competence callbacks will not be invoked\n     * @param {Boolean} [requestOptions.useEnrichmentCache]\n     * @return {$.Deferred} waiter which is to be resolved with suggestions as argument\n     */\n    getSuggestions: function(query, customParams, requestOptions) {\n        var response,\n            that = this,\n            options = that.options,\n            noCallbacks = requestOptions && requestOptions.noCallbacks,\n            useEnrichmentCache =\n                requestOptions && requestOptions.useEnrichmentCache,\n            method =\n                (requestOptions && requestOptions.method) ||\n                that.requestMode.method,\n            params = that.constructRequestParams(query, customParams),\n            cacheKey = $.param(params || {}),\n            resolver = $.Deferred();\n\n        response = that.cachedResponse[cacheKey];\n        if (response && $.isArray(response.suggestions)) {\n            resolver.resolve(response.suggestions);\n        } else {\n            if (that.isBadQuery(query)) {\n                resolver.reject();\n            } else {\n                if (\n                    !noCallbacks &&\n                    options.onSearchStart.call(that.element, params) === false\n                ) {\n                    resolver.reject();\n                } else {\n                    that.doGetSuggestions(params, method)\n                        .done(function(response) {\n                            // if response is correct and current value has not been changed\n                            if (\n                                that.processResponse(response) &&\n                                query == that.currentValue\n                            ) {\n                                // Cache results if cache is not disabled:\n                                if (!options.noCache) {\n                                    if (useEnrichmentCache) {\n                                        that.enrichmentCache[query] =\n                                            response.suggestions[0];\n                                    } else {\n                                        that.enrichResponse(response, query);\n                                        that.cachedResponse[\n                                            cacheKey\n                                        ] = response;\n                                        if (\n                                            options.preventBadQueries &&\n                                            response.suggestions.length === 0\n                                        ) {\n                                            that.badQueries.push(query);\n                                        }\n                                    }\n                                }\n\n                                resolver.resolve(response.suggestions);\n                            } else {\n                                resolver.reject();\n                            }\n                            if (!noCallbacks) {\n                                options.onSearchComplete.call(\n                                    that.element,\n                                    query,\n                                    response.suggestions\n                                );\n                            }\n                        })\n                        .fail(function(jqXHR, textStatus, errorThrown) {\n                            resolver.reject();\n                            if (!noCallbacks && textStatus !== \"abort\") {\n                                options.onSearchError.call(\n                                    that.element,\n                                    query,\n                                    jqXHR,\n                                    textStatus,\n                                    errorThrown\n                                );\n                            }\n                        });\n                }\n            }\n        }\n        return resolver;\n    },\n\n    /**\n     * Sends an AJAX request to server suggest method.\n     * @param {Object} params request params\n     * @returns {$.Deferred} response promise\n     */\n    doGetSuggestions: function(params, method) {\n        var that = this,\n            request = $.ajax(\n                that.getAjaxParams(method, { data: utils.serialize(params) })\n            );\n\n        that.abortRequest();\n        that.currentRequest = request;\n        that.notify(\"request\");\n\n        request.always(function() {\n            that.currentRequest = null;\n            that.notify(\"request\");\n        });\n\n        return request;\n    },\n\n    isBadQuery: function(q) {\n        if (!this.options.preventBadQueries) {\n            return false;\n        }\n\n        var result = false;\n        $.each(this.badQueries, function(i, query) {\n            return !(result = q.indexOf(query) === 0);\n        });\n        return result;\n    },\n\n    abortRequest: function() {\n        var that = this;\n\n        if (that.currentRequest) {\n            that.currentRequest.abort();\n        }\n    },\n\n    /**\n     * Checks response format and data\n     * @return {Boolean} response contains acceptable data\n     */\n    processResponse: function(response) {\n        var that = this,\n            suggestions;\n\n        if (!response || !$.isArray(response.suggestions)) {\n            return false;\n        }\n\n        that.verifySuggestionsFormat(response.suggestions);\n        that.setUnrestrictedValues(response.suggestions);\n\n        if ($.isFunction(that.options.onSuggestionsFetch)) {\n            suggestions = that.options.onSuggestionsFetch.call(\n                that.element,\n                response.suggestions\n            );\n            if ($.isArray(suggestions)) {\n                response.suggestions = suggestions;\n            }\n        }\n\n        return true;\n    },\n\n    verifySuggestionsFormat: function(suggestions) {\n        if (typeof suggestions[0] === \"string\") {\n            $.each(suggestions, function(i, value) {\n                suggestions[i] = { value: value, data: null };\n            });\n        }\n    },\n\n    /**\n     * Gets string to set as input value\n     *\n     * @param suggestion\n     * @param {Object} [selectionOptions]\n     * @param {boolean} selectionOptions.hasBeenEnriched\n     * @param {boolean} selectionOptions.hasSameValues\n     * @return {string}\n     */\n    getSuggestionValue: function(suggestion, selectionOptions) {\n        var that = this,\n            formatSelected =\n                that.options.formatSelected || that.type.formatSelected,\n            hasSameValues = selectionOptions && selectionOptions.hasSameValues,\n            hasBeenEnriched =\n                selectionOptions && selectionOptions.hasBeenEnriched,\n            formattedValue,\n            typeFormattedValue = null;\n\n        if ($.isFunction(formatSelected)) {\n            formattedValue = formatSelected.call(that, suggestion);\n        }\n\n        if (typeof formattedValue !== \"string\") {\n            formattedValue = suggestion.value;\n\n            if (that.type.getSuggestionValue) {\n                typeFormattedValue = that.type.getSuggestionValue(that, {\n                    suggestion: suggestion,\n                    hasSameValues: hasSameValues,\n                    hasBeenEnriched: hasBeenEnriched\n                });\n\n                if (typeFormattedValue !== null) {\n                    formattedValue = typeFormattedValue;\n                }\n            }\n        }\n\n        return formattedValue;\n    },\n\n    hasSameValues: function(suggestion) {\n        var hasSame = false;\n\n        $.each(this.suggestions, function(i, anotherSuggestion) {\n            if (\n                anotherSuggestion.value === suggestion.value &&\n                anotherSuggestion !== suggestion\n            ) {\n                hasSame = true;\n                return false;\n            }\n        });\n\n        return hasSame;\n    },\n\n    assignSuggestions: function(suggestions, query) {\n        var that = this;\n        that.suggestions = suggestions;\n        that.notify(\"assignSuggestions\", query);\n    },\n\n    shouldRestrictValues: function() {\n        var that = this;\n        // treat suggestions value as restricted only if there is one constraint\n        // and restrict_value is true\n        return (\n            that.options.restrict_value &&\n            that.constraints &&\n            Object.keys(that.constraints).length == 1\n        );\n    },\n\n    /**\n     * Fills suggestion.unrestricted_value property\n     */\n    setUnrestrictedValues: function(suggestions) {\n        var that = this,\n            shouldRestrict = that.shouldRestrictValues(),\n            label = that.getFirstConstraintLabel();\n\n        $.each(suggestions, function(i, suggestion) {\n            if (!suggestion.unrestricted_value) {\n                suggestion.unrestricted_value = shouldRestrict\n                    ? label + \", \" + suggestion.value\n                    : suggestion.value;\n            }\n        });\n    },\n\n    areSuggestionsSame: function(a, b) {\n        return a && b && a.value === b.value && utils.areSame(a.data, b.data);\n    },\n\n    getNoSuggestionsHint: function() {\n        var that = this;\n        if (that.options.noSuggestionsHint === false) {\n            return false;\n        }\n        return that.options.noSuggestionsHint || that.type.noSuggestionsHint;\n    }\n};\n\n/**\n * Methods related to INPUT's behavior\n */\n\nvar methods = {\n    setupElement: function() {\n        // Remove autocomplete attribute to prevent native suggestions:\n        this.el\n            // if it stops working, see https://stackoverflow.com/q/15738259\n            // chrome is constantly changing this logic\n            .attr(\"autocomplete\", \"new-password\")\n            .attr(\"autocorrect\", \"off\")\n            .attr(\"autocapitalize\", \"off\")\n            .attr(\"spellcheck\", \"false\")\n            .addClass(\"suggestions-input\")\n            .css(\"box-sizing\", \"border-box\");\n    },\n\n    bindElementEvents: function() {\n        var that = this;\n\n        that.el.on(\"keydown\" + EVENT_NS, $.proxy(that.onElementKeyDown, that));\n        // IE is buggy, it doesn't trigger `input` on text deletion, so use following events\n        that.el.on(\n            [\n                \"keyup\" + EVENT_NS,\n                \"cut\" + EVENT_NS,\n                \"paste\" + EVENT_NS,\n                \"input\" + EVENT_NS\n            ].join(\" \"),\n            $.proxy(that.onElementKeyUp, that)\n        );\n        that.el.on(\"blur\" + EVENT_NS, $.proxy(that.onElementBlur, that));\n        that.el.on(\"focus\" + EVENT_NS, $.proxy(that.onElementFocus, that));\n    },\n\n    unbindElementEvents: function() {\n        this.el.off(EVENT_NS);\n    },\n\n    onElementBlur: function() {\n        var that = this;\n\n        // suggestion was clicked, blur should be ignored\n        // see container mousedown handler\n        if (that.cancelBlur) {\n            that.cancelBlur = false;\n            return;\n        }\n\n        if (that.options.triggerSelectOnBlur) {\n            if (!that.isUnavailable()) {\n                that.selectCurrentValue({ noSpace: true }).always(function() {\n                    // For NAMEs selecting keeps suggestions list visible, so hide it\n                    that.hide();\n                });\n            }\n        } else {\n            that.hide();\n        }\n\n        if (that.fetchPhase.abort) {\n            that.fetchPhase.abort();\n        }\n    },\n\n    onElementFocus: function() {\n        var that = this;\n\n        if (!that.cancelFocus) {\n            // defer methods to allow browser update input's style before\n            utils.delay($.proxy(that.completeOnFocus, that));\n        }\n        that.cancelFocus = false;\n    },\n\n    onElementKeyDown: function(e) {\n        var that = this;\n\n        if (that.isUnavailable()) {\n            return;\n        }\n\n        if (!that.visible) {\n            switch (e.which) {\n                // If suggestions are hidden and user presses arrow down, display suggestions\n                case KEYS.DOWN:\n                    that.suggest();\n                    break;\n                // if no suggestions available and user pressed Enter\n                case KEYS.ENTER:\n                    if (that.options.triggerSelectOnEnter) {\n                        that.triggerOnSelectNothing();\n                    }\n                    break;\n            }\n            return;\n        }\n\n        switch (e.which) {\n            case KEYS.ESC:\n                that.el.val(that.currentValue);\n                that.hide();\n                that.abortRequest();\n                break;\n\n            case KEYS.TAB:\n                if (that.options.tabDisabled === false) {\n                    return;\n                }\n                break;\n\n            case KEYS.ENTER:\n                if (that.options.triggerSelectOnEnter) {\n                    that.selectCurrentValue();\n                }\n                break;\n\n            case KEYS.SPACE:\n                if (that.options.triggerSelectOnSpace && that.isCursorAtEnd()) {\n                    e.preventDefault();\n                    that.selectCurrentValue({\n                        continueSelecting: true,\n                        dontEnrich: true\n                    }).fail(function() {\n                        // If all data fetched but nothing selected\n                        that.currentValue += \" \";\n                        that.el.val(that.currentValue);\n                        that.proceedChangedValue();\n                    });\n                }\n                return;\n            case KEYS.UP:\n                that.moveUp();\n                break;\n            case KEYS.DOWN:\n                that.moveDown();\n                break;\n            default:\n                return;\n        }\n\n        // Cancel event if function did not return:\n        e.stopImmediatePropagation();\n        e.preventDefault();\n    },\n\n    onElementKeyUp: function(e) {\n        var that = this;\n\n        if (that.isUnavailable()) {\n            return;\n        }\n\n        switch (e.which) {\n            case KEYS.UP:\n            case KEYS.DOWN:\n            case KEYS.ENTER:\n                return;\n        }\n\n        // Cancel pending change\n        clearTimeout(that.onChangeTimeout);\n        that.inputPhase.reject();\n\n        if (that.currentValue !== that.el.val()) {\n            that.proceedChangedValue();\n        }\n    },\n\n    proceedChangedValue: function() {\n        var that = this;\n\n        // Cancel fetching, because it became obsolete\n        that.abortRequest();\n\n        that.inputPhase = $.Deferred().done($.proxy(that.onValueChange, that));\n\n        if (that.options.deferRequestBy > 0) {\n            // Defer lookup in case when value changes very quickly:\n            that.onChangeTimeout = utils.delay(function() {\n                that.inputPhase.resolve();\n            }, that.options.deferRequestBy);\n        } else {\n            that.inputPhase.resolve();\n        }\n    },\n\n    onValueChange: function() {\n        var that = this,\n            currentSelection;\n\n        if (that.selection) {\n            currentSelection = that.selection;\n            that.selection = null;\n            that.trigger(\"InvalidateSelection\", currentSelection);\n        }\n\n        that.selectedIndex = -1;\n\n        that.update();\n        that.notify(\"valueChange\");\n    },\n\n    completeOnFocus: function() {\n        var that = this;\n\n        if (that.isUnavailable()) {\n            return;\n        }\n\n        if (that.isElementFocused()) {\n            that.update();\n            if (that.isMobile) {\n                that.setCursorAtEnd();\n                that.scrollToTop();\n            }\n        }\n    },\n\n    isElementFocused: function() {\n        return document.activeElement === this.element;\n    },\n\n    isElementDisabled: function() {\n        return Boolean(\n            this.element.getAttribute(\"disabled\") ||\n                this.element.getAttribute(\"readonly\")\n        );\n    },\n\n    isCursorAtEnd: function() {\n        var that = this,\n            valLength = that.el.val().length,\n            selectionStart,\n            range;\n\n        // `selectionStart` and `selectionEnd` are not supported by some input types\n        try {\n            selectionStart = that.element.selectionStart;\n            if (typeof selectionStart === \"number\") {\n                return selectionStart === valLength;\n            }\n        } catch (ex) {}\n\n        if (document.selection) {\n            range = document.selection.createRange();\n            range.moveStart(\"character\", -valLength);\n            return valLength === range.text.length;\n        }\n        return true;\n    },\n\n    setCursorAtEnd: function() {\n        var element = this.element;\n\n        // `selectionStart` and `selectionEnd` are not supported by some input types\n        try {\n            element.selectionEnd = element.selectionStart =\n                element.value.length;\n            element.scrollLeft = element.scrollWidth;\n        } catch (ex) {\n            element.value = element.value;\n        }\n    }\n};\n\n$.extend(Suggestions.prototype, methods);\n\nnotificator\n    .on(\"initialize\", methods.bindElementEvents)\n    .on(\"dispose\", methods.unbindElementEvents);\n\n/**\n * Methods related to plugin's authorization on server\n */\n\n// keys are \"[type][token]\"\nvar statusRequests = {};\n\nfunction resetTokens() {\n    utils.each(statusRequests, function(req) {\n        req.abort();\n    });\n    statusRequests = {};\n}\n\nresetTokens();\n\nvar methods$1 = {\n    checkStatus: function() {\n        var that = this,\n            token = (that.options.token && that.options.token.trim()) || \"\",\n            requestKey = that.options.type + token,\n            request = statusRequests[requestKey];\n\n        if (!request) {\n            request = statusRequests[requestKey] = jqapi.ajax(\n                that.getAjaxParams(\"status\")\n            );\n        }\n\n        request\n            .done(function(status, textStatus, request) {\n                if (status.search) {\n                    var plan = request.getResponseHeader(\"X-Plan\");\n                    status.plan = plan;\n                    jqapi.extend(that.status, status);\n                } else {\n                    triggerError(\"Service Unavailable\");\n                }\n            })\n            .fail(function() {\n                triggerError(request.statusText);\n            });\n\n        function triggerError(errorThrown) {\n            // If unauthorized\n            if (utils.isFunction(that.options.onSearchError)) {\n                that.options.onSearchError.call(\n                    that.element,\n                    null,\n                    request,\n                    \"error\",\n                    errorThrown\n                );\n            }\n        }\n    }\n};\n\nSuggestions.resetTokens = resetTokens;\n\njqapi.extend(Suggestions.prototype, methods$1);\n\nnotificator.on(\"setOptions\", methods$1.checkStatus);\n\n//export { methods, resetTokens };\n\nvar locationRequest;\nvar defaultGeoLocation = true;\n\nfunction resetLocation() {\n    locationRequest = null;\n    DEFAULT_OPTIONS.geoLocation = defaultGeoLocation;\n}\n\nvar methods$2 = {\n    checkLocation: function() {\n        var that = this,\n            providedLocation = that.options.geoLocation;\n\n        if (!that.type.geoEnabled || !providedLocation) {\n            return;\n        }\n\n        that.geoLocation = $.Deferred();\n        if ($.isPlainObject(providedLocation) || $.isArray(providedLocation)) {\n            that.geoLocation.resolve(providedLocation);\n        } else {\n            if (!locationRequest) {\n                locationRequest = $.ajax(\n                    that.getAjaxParams(\"iplocate/address\")\n                );\n            }\n\n            locationRequest\n                .done(function(resp) {\n                    var locationData =\n                        resp && resp.location && resp.location.data;\n                    if (locationData && locationData.kladr_id) {\n                        that.geoLocation.resolve({\n                            kladr_id: locationData.kladr_id\n                        });\n                    } else {\n                        that.geoLocation.reject();\n                    }\n                })\n                .fail(function() {\n                    that.geoLocation.reject();\n                });\n        }\n    },\n\n    /**\n     * Public method to get `geoLocation` promise\n     * @returns {$.Deferred}\n     */\n    getGeoLocation: function() {\n        return this.geoLocation;\n    },\n\n    constructParams: function() {\n        var that = this,\n            params = {};\n\n        if (\n            that.geoLocation &&\n            $.isFunction(that.geoLocation.promise) &&\n            that.geoLocation.state() == \"resolved\"\n        ) {\n            that.geoLocation.done(function(locationData) {\n                params[\"locations_boost\"] = $.makeArray(locationData);\n            });\n        }\n\n        return params;\n    }\n};\n\n// Disable this feature when GET method used. See SUG-202\nif (utils.getDefaultType() != \"GET\") {\n    $.extend(DEFAULT_OPTIONS, {\n        geoLocation: defaultGeoLocation\n    });\n\n    $.extend(Suggestions, {\n        resetLocation: resetLocation\n    });\n\n    $.extend(Suggestions.prototype, {\n        getGeoLocation: methods$2.getGeoLocation\n    });\n\n    notificator\n        .on(\"setOptions\", methods$2.checkLocation)\n        .on(\"requestParams\", methods$2.constructParams);\n}\n\nvar methods$3 = {\n    enrichSuggestion: function(suggestion, selectionOptions) {\n        var that = this,\n            resolver = $.Deferred();\n\n        if (\n            !that.options.enrichmentEnabled ||\n            !that.type.enrichmentEnabled ||\n            !that.requestMode.enrichmentEnabled ||\n            (selectionOptions && selectionOptions.dontEnrich)\n        ) {\n            return resolver.resolve(suggestion);\n        }\n\n        // if current suggestion is already enriched, use it\n        if (suggestion.data && suggestion.data.qc != null) {\n            return resolver.resolve(suggestion);\n        }\n\n        that.disableDropdown();\n\n        var query = that.type.getEnrichmentQuery(suggestion);\n        var customParams = that.type.enrichmentParams;\n        var requestOptions = {\n            noCallbacks: true,\n            useEnrichmentCache: true,\n            method: that.type.enrichmentMethod\n        };\n\n        // Set `currentValue` to make `processResponse` to consider enrichment response valid\n        that.currentValue = query;\n\n        // prevent request abortion during onBlur\n        that.enrichPhase = that\n            .getSuggestions(query, customParams, requestOptions)\n            .always(function() {\n                that.enableDropdown();\n            })\n            .done(function(suggestions) {\n                var enrichedSuggestion = suggestions && suggestions[0];\n\n                resolver.resolve(\n                    enrichedSuggestion || suggestion,\n                    !!enrichedSuggestion\n                );\n            })\n            .fail(function() {\n                resolver.resolve(suggestion);\n            });\n\n        return resolver;\n    },\n\n    /**\n     * Injects enriched suggestion into response\n     * @param response\n     * @param query\n     */\n    enrichResponse: function(response, query) {\n        var that = this,\n            enrichedSuggestion = that.enrichmentCache[query];\n\n        if (enrichedSuggestion) {\n            $.each(response.suggestions, function(i, suggestion) {\n                if (suggestion.value === query) {\n                    response.suggestions[i] = enrichedSuggestion;\n                    return false;\n                }\n            });\n        }\n    }\n};\n\n$.extend(Suggestions.prototype, methods$3);\n\n/**\n * Methods related to suggestions dropdown list\n */\n\nfunction highlightMatches(chunks) {\n    return $.map(chunks, function(chunk) {\n        var text = utils.escapeHtml(chunk.text);\n\n        if (text && chunk.matched) {\n            text = \"<strong>\" + text + \"</strong>\";\n        }\n        return text;\n    }).join(\"\");\n}\n\nfunction nowrapLinkedParts(formattedStr, nowrapClass) {\n    var delimitedParts = formattedStr.split(\", \");\n    // string has no delimiters, should not wrap\n    if (delimitedParts.length === 1) {\n        return formattedStr;\n    }\n    // disable word-wrap inside delimited parts\n    return $.map(delimitedParts, function(part) {\n        return '<span class=\"' + nowrapClass + '\">' + part + \"</span>\";\n    }).join(\", \");\n}\n\nfunction hasAnotherSuggestion(suggestions, suggestion) {\n    var result = false;\n\n    $.each(suggestions, function(i, s) {\n        result = s.value == suggestion.value && s != suggestion;\n        if (result) {\n            return false;\n        }\n    });\n\n    return result;\n}\n\nvar optionsUsed = {\n    width: \"auto\",\n    floating: false\n};\n\nvar methods$4 = {\n    createContainer: function() {\n        var that = this,\n            suggestionSelector = \".\" + that.classes.suggestion,\n            options = that.options,\n            $container = $(\"<div/>\")\n                .addClass(options.containerClass)\n                .css({\n                    display: \"none\"\n                });\n\n        that.$container = $container;\n\n        $container.on(\n            \"click\" + EVENT_NS,\n            suggestionSelector,\n            $.proxy(that.onSuggestionClick, that)\n        );\n    },\n\n    showContainer: function() {\n        this.$container.appendTo(\n            this.options.floating ? this.$body : this.$wrapper\n        );\n    },\n\n    getContainer: function() {\n        return this.$container.get(0);\n    },\n\n    removeContainer: function() {\n        var that = this;\n\n        if (that.options.floating) {\n            that.$container.remove();\n        }\n    },\n\n    setContainerOptions: function() {\n        var that = this,\n            mousedownEvent = \"mousedown\" + EVENT_NS;\n\n        that.$container.off(mousedownEvent);\n        if (that.options.floating) {\n            that.$container.on(mousedownEvent, $.proxy(that.onMousedown, that));\n        }\n    },\n\n    /**\n     * Listen for click event on suggestions list:\n     */\n    onSuggestionClick: function(e) {\n        var that = this,\n            $el = $(e.target),\n            index;\n\n        if (!that.dropdownDisabled) {\n            that.cancelFocus = true;\n            that.el.focus();\n\n            while ($el.length && !(index = $el.attr(\"data-index\"))) {\n                $el = $el.closest(\".\" + that.classes.suggestion);\n            }\n\n            if (index && !isNaN(index)) {\n                that.select(+index);\n            }\n        }\n    },\n\n    // Dropdown UI methods\n\n    getSuggestionsItems: function() {\n        return this.$container.children(\".\" + this.classes.suggestion);\n    },\n\n    toggleDropdownEnabling: function(enable) {\n        this.dropdownDisabled = !enable;\n        this.$container.attr(\"disabled\", !enable);\n    },\n\n    disableDropdown: function() {\n        this.toggleDropdownEnabling(false);\n    },\n\n    enableDropdown: function() {\n        this.toggleDropdownEnabling(true);\n    },\n\n    /**\n     * Shows if there are any suggestions besides currently selected\n     * @returns {boolean}\n     */\n    hasSuggestionsToChoose: function() {\n        var that = this;\n\n        return (\n            that.suggestions.length > 1 ||\n            (that.suggestions.length === 1 &&\n                (!that.selection ||\n                    $.trim(that.suggestions[0].value) !==\n                        $.trim(that.selection.value)))\n        );\n    },\n\n    suggest: function() {\n        var that = this,\n            options = that.options,\n            formatResult,\n            html = [];\n\n        if (!that.requestMode.userSelect) {\n            return;\n        }\n\n        //   ,    \n        if (!that.hasSuggestionsToChoose()) {\n            if (that.suggestions.length) {\n                that.hide();\n                return;\n            } else {\n                var noSuggestionsHint = that.getNoSuggestionsHint();\n                if (noSuggestionsHint) {\n                    html.push(\n                        '<div class=\"' +\n                            that.classes.hint +\n                            '\">' +\n                            noSuggestionsHint +\n                            \"</div>\"\n                    );\n                } else {\n                    that.hide();\n                    return;\n                }\n            }\n        } else {\n            // Build hint html\n            if (options.hint && that.suggestions.length) {\n                html.push(\n                    '<div class=\"' +\n                        that.classes.hint +\n                        '\">' +\n                        options.hint +\n                        \"</div>\"\n                );\n            }\n            that.selectedIndex = -1;\n            // Build suggestions inner HTML:\n            that.suggestions.forEach(function(suggestion, i) {\n                if (suggestion == that.selection) {\n                    that.selectedIndex = i;\n                }\n                that.buildSuggestionHtml(suggestion, i, html);\n            });\n        }\n\n        html.push('<div class=\"' + CLASSES.promo + '\"></div>');\n        html.push(\"</div>\");\n\n        that.$container.html(html.join(\"\"));\n\n        // Select first value by default:\n        if (options.autoSelectFirst && that.selectedIndex === -1) {\n            that.selectedIndex = 0;\n        }\n        if (that.selectedIndex !== -1) {\n            that.getSuggestionsItems()\n                .eq(that.selectedIndex)\n                .addClass(that.classes.selected);\n        }\n\n        if ($.isFunction(options.beforeRender)) {\n            options.beforeRender.call(that.element, that.$container);\n        }\n\n        that.$container.show();\n        that.visible = true;\n    },\n\n    buildSuggestionHtml: function(suggestion, ordinal, html) {\n        html.push(\n            '<div class=\"' +\n                this.classes.suggestion +\n                '\" data-index=\"' +\n                ordinal +\n                '\">'\n        );\n\n        var formatResult =\n            this.options.formatResult ||\n            this.type.formatResult ||\n            this.formatResult;\n        html.push(\n            formatResult.call(\n                this,\n                suggestion.value,\n                this.currentValue,\n                suggestion,\n                {\n                    unformattableTokens: this.type.unformattableTokens\n                }\n            )\n        );\n\n        var labels = this.makeSuggestionLabel(this.suggestions, suggestion);\n        if (labels) {\n            html.push(\n                '<span class=\"' +\n                    this.classes.subtext_label +\n                    '\">' +\n                    utils.escapeHtml(labels) +\n                    \"</span>\"\n            );\n        }\n        html.push(\"</div>\");\n    },\n\n    wrapFormattedValue: function(value, suggestion) {\n        var that = this,\n            status = utils.getDeepValue(suggestion.data, \"state.status\");\n\n        return (\n            '<span class=\"' +\n            that.classes.value +\n            '\"' +\n            (status ? ' data-suggestion-status=\"' + status + '\"' : \"\") +\n            \">\" +\n            value +\n            \"</span>\"\n        );\n    },\n\n    formatResult: function(value, currentValue, suggestion, options) {\n        var that = this;\n\n        value = that.highlightMatches(value, currentValue, suggestion, options);\n\n        return that.wrapFormattedValue(value, suggestion);\n    },\n\n    /**\n     * Makes HTML contents for suggestion item\n     * @param {String} value string to be displayed as a value\n     * @param {String} currentValue contents of the textbox\n     * @param suggestion whole suggestion object with displaying value and other fields\n     * @param {Object} [options] set of flags:\n     *          `unformattableTokens` - array of search tokens, that are not to be highlighted\n     *          `maxLength` - if set, `value` is limited by this length\n     * @returns {String} HTML to be inserted in the list\n     */\n    highlightMatches: function(value, currentValue, suggestion, options) {\n        var that = this,\n            chunks = [],\n            unformattableTokens = options && options.unformattableTokens,\n            maxLength = options && options.maxLength,\n            tokens,\n            tokenMatchers,\n            preferredTokens,\n            rWords = utils.reWordExtractor(),\n            match,\n            word,\n            i,\n            chunk,\n            formattedStr;\n\n        if (!value) return \"\";\n\n        tokens = text_util.tokenize(currentValue, unformattableTokens);\n\n        tokenMatchers = $.map(tokens, function(token) {\n            return new RegExp(\n                \"^((.*)([\" +\n                    WORD_PARTS_DELIMITERS +\n                    \"]+))?\" +\n                    \"(\" +\n                    utils.escapeRegExChars(token) +\n                    \")\" +\n                    \"([^\" +\n                    WORD_PARTS_DELIMITERS +\n                    \"]*[\" +\n                    WORD_PARTS_DELIMITERS +\n                    \"]*)\",\n                \"i\"\n            );\n        });\n\n        // parse string by words\n        while ((match = rWords.exec(value)) && match[0]) {\n            word = match[1];\n            chunks.push({\n                text: word,\n\n                // upper case means a word is a name and can be highlighted even if presents in unformattableTokens\n                hasUpperCase: word.toLowerCase() !== word,\n                formatted: utils.formatToken(word),\n                matchable: true\n            });\n            if (match[2]) {\n                chunks.push({\n                    text: match[2]\n                });\n            }\n        }\n\n        // use simple loop because length can change\n        for (i = 0; i < chunks.length; i++) {\n            chunk = chunks[i];\n            if (\n                chunk.matchable &&\n                !chunk.matched &&\n                ($.inArray(chunk.formatted, unformattableTokens) === -1 ||\n                    chunk.hasUpperCase)\n            ) {\n                $.each(tokenMatchers, function(j, matcher) {\n                    var tokenMatch = matcher.exec(chunk.formatted),\n                        length,\n                        nextIndex = i + 1;\n\n                    if (tokenMatch) {\n                        tokenMatch = {\n                            before: tokenMatch[1] || \"\",\n                            beforeText: tokenMatch[2] || \"\",\n                            beforeDelimiter: tokenMatch[3] || \"\",\n                            text: tokenMatch[4] || \"\",\n                            after: tokenMatch[5] || \"\"\n                        };\n\n                        if (tokenMatch.before) {\n                            // insert chunk before current\n                            chunks.splice(\n                                i,\n                                0,\n                                {\n                                    text: chunk.text.substr(\n                                        0,\n                                        tokenMatch.beforeText.length\n                                    ),\n                                    formatted: tokenMatch.beforeText,\n                                    matchable: true\n                                },\n                                {\n                                    text: tokenMatch.beforeDelimiter\n                                }\n                            );\n                            nextIndex += 2;\n\n                            length = tokenMatch.before.length;\n                            chunk.text = chunk.text.substr(length);\n                            chunk.formatted = chunk.formatted.substr(length);\n                            i--;\n                        }\n\n                        length =\n                            tokenMatch.text.length + tokenMatch.after.length;\n                        if (chunk.formatted.length > length) {\n                            chunks.splice(nextIndex, 0, {\n                                text: chunk.text.substr(length),\n                                formatted: chunk.formatted.substr(length),\n                                matchable: true\n                            });\n                            chunk.text = chunk.text.substr(0, length);\n                            chunk.formatted = chunk.formatted.substr(0, length);\n                        }\n\n                        if (tokenMatch.after) {\n                            length = tokenMatch.text.length;\n                            chunks.splice(nextIndex, 0, {\n                                text: chunk.text.substr(length),\n                                formatted: chunk.formatted.substr(length)\n                            });\n                            chunk.text = chunk.text.substr(0, length);\n                            chunk.formatted = chunk.formatted.substr(0, length);\n                        }\n                        chunk.matched = true;\n                        return false;\n                    }\n                });\n            }\n        }\n\n        if (maxLength) {\n            for (i = 0; i < chunks.length && maxLength >= 0; i++) {\n                chunk = chunks[i];\n                maxLength -= chunk.text.length;\n                if (maxLength < 0) {\n                    chunk.text =\n                        chunk.text.substr(0, chunk.text.length + maxLength) +\n                        \"...\";\n                }\n            }\n            chunks.length = i;\n        }\n\n        formattedStr = highlightMatches(chunks);\n        return nowrapLinkedParts(formattedStr, that.classes.nowrap);\n    },\n\n    makeSuggestionLabel: function(suggestions, suggestion) {\n        var that = this,\n            fieldNames = that.type.fieldNames,\n            nameData = {},\n            rWords = utils.reWordExtractor(),\n            match,\n            word,\n            labels = [];\n\n        if (\n            fieldNames &&\n            hasAnotherSuggestion(suggestions, suggestion) &&\n            suggestion.data\n        ) {\n            $.each(fieldNames, function(field) {\n                var value = suggestion.data[field];\n                if (value) {\n                    nameData[field] = utils.formatToken(value);\n                }\n            });\n\n            if (!$.isEmptyObject(nameData)) {\n                while (\n                    (match = rWords.exec(\n                        utils.formatToken(suggestion.value)\n                    )) &&\n                    (word = match[1])\n                ) {\n                    $.each(nameData, function(i, value) {\n                        if (value == word) {\n                            labels.push(fieldNames[i]);\n                            delete nameData[i];\n                            return false;\n                        }\n                    });\n                }\n\n                if (labels.length) {\n                    return labels.join(\", \");\n                }\n            }\n        }\n    },\n\n    hide: function() {\n        var that = this;\n        that.visible = false;\n        that.selectedIndex = -1;\n        that.$container.hide().empty();\n    },\n\n    activate: function(index) {\n        var that = this,\n            $activeItem,\n            selected = that.classes.selected,\n            $children;\n\n        if (!that.dropdownDisabled) {\n            $children = that.getSuggestionsItems();\n\n            $children.removeClass(selected);\n\n            that.selectedIndex = index;\n\n            if (\n                that.selectedIndex !== -1 &&\n                $children.length > that.selectedIndex\n            ) {\n                $activeItem = $children.eq(that.selectedIndex);\n                $activeItem.addClass(selected);\n                return $activeItem;\n            }\n        }\n\n        return null;\n    },\n\n    deactivate: function(restoreValue) {\n        var that = this;\n\n        if (!that.dropdownDisabled) {\n            that.selectedIndex = -1;\n            that.getSuggestionsItems().removeClass(that.classes.selected);\n            if (restoreValue) {\n                that.el.val(that.currentValue);\n            }\n        }\n    },\n\n    moveUp: function() {\n        var that = this;\n\n        if (that.dropdownDisabled) {\n            return;\n        }\n        if (that.selectedIndex === -1) {\n            if (that.suggestions.length) {\n                that.adjustScroll(that.suggestions.length - 1);\n            }\n            return;\n        }\n\n        if (that.selectedIndex === 0) {\n            that.deactivate(true);\n            return;\n        }\n\n        that.adjustScroll(that.selectedIndex - 1);\n    },\n\n    moveDown: function() {\n        var that = this;\n\n        if (that.dropdownDisabled) {\n            return;\n        }\n        if (that.selectedIndex === that.suggestions.length - 1) {\n            that.deactivate(true);\n            return;\n        }\n\n        that.adjustScroll(that.selectedIndex + 1);\n    },\n\n    adjustScroll: function(index) {\n        var that = this,\n            $activeItem = that.activate(index),\n            itemTop,\n            itemBottom,\n            scrollTop = that.$container.scrollTop(),\n            containerHeight;\n\n        if (!$activeItem || !$activeItem.length) {\n            return;\n        }\n\n        itemTop = $activeItem.position().top;\n        if (itemTop < 0) {\n            that.$container.scrollTop(scrollTop + itemTop);\n        } else {\n            itemBottom = itemTop + $activeItem.outerHeight();\n            containerHeight = that.$container.innerHeight();\n            if (itemBottom > containerHeight) {\n                that.$container.scrollTop(\n                    scrollTop - containerHeight + itemBottom\n                );\n            }\n        }\n\n        that.el.val(that.suggestions[index].value);\n    }\n};\n\n$.extend(DEFAULT_OPTIONS, optionsUsed);\n\n$.extend(Suggestions.prototype, methods$4);\n\nnotificator\n    .on(\"initialize\", methods$4.createContainer)\n    .on(\"dispose\", methods$4.removeContainer)\n    .on(\"setOptions\", methods$4.setContainerOptions)\n    .on(\"ready\", methods$4.showContainer)\n    .on(\"assignSuggestions\", methods$4.suggest);\n\n/**\n * Methods related to CONSTRAINTS component\n */\nvar optionsUsed$1 = {\n    constraints: null,\n    restrict_value: false\n};\n\nvar fiasParamNames = [\n    \"country_iso_code\",\n    \"region_iso_code\",\n    \"region_fias_id\",\n    \"area_fias_id\",\n    \"city_fias_id\",\n    \"city_district_fias_id\",\n    \"settlement_fias_id\",\n    \"planning_structure_fias_id\",\n    \"street_fias_id\"\n];\n\n/**\n * Compares two suggestion objects\n * @param suggestion\n * @param instance other Suggestions instance\n */\nfunction belongsToArea(suggestion, instance) {\n    var parentSuggestion = instance.selection,\n        result = parentSuggestion && parentSuggestion.data && instance.bounds;\n\n    if (result) {\n        collection_util.each(instance.bounds.all, function(bound, i) {\n            return (result =\n                parentSuggestion.data[bound] === suggestion.data[bound]);\n        });\n    }\n    return result;\n}\n\n/**\n *  -,     \n * 50 000 040 000 00  50 000 040\n * @param kladr_id\n * @returns {string}\n */\nfunction getSignificantKladrId(kladr_id) {\n    var significantKladrId = kladr_id.replace(/^(\\d{2})(\\d*?)(0+)$/g, \"$1$2\");\n    var length = significantKladrId.length;\n    var significantLength = -1;\n    if (length <= 2) {\n        significantLength = 2;\n    } else if (length > 2 && length <= 5) {\n        significantLength = 5;\n    } else if (length > 5 && length <= 8) {\n        significantLength = 8;\n    } else if (length > 8 && length <= 11) {\n        significantLength = 11;\n    } else if (length > 11 && length <= 15) {\n        significantLength = 15;\n    } else if (length > 15) {\n        significantLength = 19;\n    }\n    return text_util.padEnd(significantKladrId, significantLength, \"0\");\n}\n\n/**\n * @param {Object} data  fields\n * @param {Suggestions} instance\n * @constructor\n */\nvar ConstraintLocation = function(data, instance) {\n    var that = this,\n        fieldNames,\n        fiasFieldNames,\n        fiasFields = {};\n\n    that.instance = instance;\n    that.fields = {};\n    that.specificity = -1;\n\n    if (lang_util.isPlainObject(data) && instance.type.dataComponents) {\n        collection_util.each(instance.type.dataComponents, function(\n            component,\n            i\n        ) {\n            var fieldName = component.id;\n\n            if (component.forLocations && data[fieldName]) {\n                that.fields[fieldName] = data[fieldName];\n                that.specificity = i;\n            }\n        });\n    }\n\n    fieldNames = Object.keys(that.fields);\n    fiasFieldNames = collection_util.intersect(fieldNames, fiasParamNames);\n    if (fiasFieldNames.length) {\n        collection_util.each(fiasFieldNames, function(fieldName, index) {\n            fiasFields[fieldName] = that.fields[fieldName];\n        });\n        that.fields = fiasFields;\n        that.specificity = that.getFiasSpecificity(fiasFieldNames);\n    } else if (that.fields.kladr_id) {\n        that.fields = { kladr_id: that.fields.kladr_id };\n        that.significantKladr = getSignificantKladrId(that.fields.kladr_id);\n        that.specificity = that.getKladrSpecificity(that.significantKladr);\n    }\n};\n\njqapi.extend(ConstraintLocation.prototype, {\n    getLabel: function() {\n        return this.instance.type.composeValue(this.fields, {\n            saveCityDistrict: true\n        });\n    },\n\n    getFields: function() {\n        return this.fields;\n    },\n\n    isValid: function() {\n        return !lang_util.isEmptyObject(this.fields);\n    },\n\n    /**\n     *  specificity  \n     *  ,  getFiasSpecificity\n     * @param kladr_id\n     * @returns {number}\n     */\n    getKladrSpecificity: function(kladr_id) {\n        var specificity = -1;\n        var kladrLength = kladr_id.length;\n\n        collection_util.each(this.instance.type.dataComponents, function(\n            component,\n            i\n        ) {\n            if (\n                component.kladrFormat &&\n                kladrLength === component.kladrFormat.digits\n            ) {\n                specificity = i;\n            }\n        });\n\n        return specificity;\n    },\n\n    /**\n     *    specificity  \n     * Specificity     this.instance.type.dataComponents\n     *   ()       .\n     *     ,     restrict_value = true\n     * ,   (locations)  region_fias_id ( )\n     *     \". \"\n     *  restrict_value ,    \" ,  \"\n     *  ,   \" \"\n     *\n     * @param fiasFieldNames\n     * @returns {number}\n     */\n    getFiasSpecificity: function(fiasFieldNames) {\n        var specificity = -1;\n\n        collection_util.each(this.instance.type.dataComponents, function(\n            component,\n            i\n        ) {\n            if (\n                component.fiasType &&\n                fiasFieldNames.indexOf(component.fiasType) > -1 &&\n                specificity < i\n            ) {\n                specificity = i;\n            }\n        });\n\n        return specificity;\n    },\n\n    containsData: function(data) {\n        var result = true;\n\n        if (this.fields.kladr_id) {\n            return (\n                !!data.kladr_id &&\n                data.kladr_id.indexOf(this.significantKladr) === 0\n            );\n        } else {\n            collection_util.each(this.fields, function(value, fieldName) {\n                return (result =\n                    !!data[fieldName] &&\n                    data[fieldName].toLowerCase() === value.toLowerCase());\n            });\n\n            return result;\n        }\n    }\n});\n\nSuggestions.ConstraintLocation = ConstraintLocation;\n\n/**\n * @param {Object} data\n * @param {Object|Array} data.locations\n * @param {string} [data.label]\n * @param {boolean} [data.deletable]\n * @param {Suggestions} [instance]\n * @constructor\n */\nvar Constraint = function(data, instance) {\n    this.id = generateId(\"c\");\n    this.deletable = !!data.deletable;\n    this.instance = instance;\n\n    var locationsArray = collection_util.makeArray(\n        data && (data.locations || data.restrictions)\n    );\n    this.locations = locationsArray.map(function(data) {\n        return new ConstraintLocation(data, instance);\n    });\n\n    this.locations = this.locations.filter(function(location) {\n        return location.isValid();\n    });\n\n    this.label = data.label;\n    if (this.label == null && instance.type.composeValue) {\n        this.label = this.locations\n            .map(function(location) {\n                return location.getLabel();\n            })\n            .join(\", \");\n    }\n};\n\njqapi.extend(Constraint.prototype, {\n    isValid: function() {\n        return this.locations.length > 0;\n    },\n    getFields: function() {\n        return this.locations.map(function(location) {\n            return location.getFields();\n        });\n    }\n});\n\nvar methods$5 = {\n    createConstraints: function() {\n        var that = this;\n        that.constraints = {};\n    },\n    setupConstraints: function() {\n        var that = this,\n            constraints = that.options.constraints,\n            $parent;\n\n        if (!constraints) {\n            that.unbindFromParent();\n            return;\n        }\n\n        if (\n            jqapi.isJqObject(constraints) ||\n            typeof constraints === \"string\" ||\n            typeof constraints.nodeType === \"number\"\n        ) {\n            $parent = jqapi.select(constraints);\n            if (!$parent.is(that.constraints)) {\n                that.unbindFromParent();\n                if (!$parent.is(that.el)) {\n                    that.constraints = $parent;\n                    that.bindToParent();\n                }\n            }\n        } else {\n            collection_util.each(that.constraints, function(_, id) {\n                that.removeConstraint(id);\n            });\n            collection_util.each(\n                collection_util.makeArray(constraints),\n                function(constraint, i) {\n                    that.addConstraint(constraint);\n                }\n            );\n        }\n    },\n\n    filteredLocation: function(data) {\n        var locationComponents = [],\n            location = {};\n\n        collection_util.each(this.type.dataComponents, function() {\n            if (this.forLocations) locationComponents.push(this.id);\n        });\n\n        if (lang_util.isPlainObject(data)) {\n            // Copy to location only allowed fields\n            collection_util.each(data, function(value, key) {\n                if (value && locationComponents.indexOf(key) >= 0) {\n                    location[key] = value;\n                }\n            });\n        }\n\n        if (!lang_util.isEmptyObject(location)) {\n            return location.kladr_id\n                ? { kladr_id: location.kladr_id }\n                : location;\n        }\n    },\n\n    addConstraint: function(constraint) {\n        var that = this;\n\n        constraint = new Constraint(constraint, that);\n\n        if (constraint.isValid()) {\n            that.constraints[constraint.id] = constraint;\n        }\n    },\n\n    removeConstraint: function(id) {\n        var that = this;\n        delete that.constraints[id];\n    },\n\n    constructConstraintsParams: function() {\n        var that = this,\n            locations = [],\n            constraints = that.constraints,\n            parentInstance,\n            parentData,\n            params = {};\n\n        while (\n            jqapi.isJqObject(constraints) &&\n            (parentInstance = constraints.suggestions()) &&\n            !(parentData = object_util.getDeepValue(\n                parentInstance,\n                \"selection.data\"\n            ))\n        ) {\n            constraints = parentInstance.constraints;\n        }\n\n        if (jqapi.isJqObject(constraints)) {\n            parentData = new ConstraintLocation(\n                parentData,\n                parentInstance\n            ).getFields();\n\n            if (parentData) {\n                // if send city_fias_id for city request\n                // then no cities will responded\n                if (that.bounds.own.indexOf(\"city\") > -1) {\n                    delete parentData.city_fias_id;\n                }\n                params.locations = [parentData];\n                params.restrict_value = true;\n            }\n        } else {\n            if (constraints) {\n                collection_util.each(constraints, function(constraint, id) {\n                    locations = locations.concat(constraint.getFields());\n                });\n\n                if (locations.length) {\n                    params.locations = locations;\n                    params.restrict_value = that.options.restrict_value;\n                }\n            }\n        }\n\n        return params;\n    },\n\n    /**\n     * Returns label of the first constraint (if any), empty string otherwise\n     * @returns {String}\n     */\n    getFirstConstraintLabel: function() {\n        var that = this,\n            constraints_id =\n                lang_util.isPlainObject(that.constraints) &&\n                Object.keys(that.constraints)[0];\n\n        return constraints_id ? that.constraints[constraints_id].label : \"\";\n    },\n\n    bindToParent: function() {\n        var that = this;\n\n        that.constraints\n            .on(\n                [\n                    \"suggestions-select.\" + that.uniqueId,\n                    \"suggestions-invalidateselection.\" + that.uniqueId,\n                    \"suggestions-clear.\" + that.uniqueId\n                ].join(\" \"),\n                jqapi.proxy(that.onParentSelectionChanged, that)\n            )\n            .on(\n                \"suggestions-dispose.\" + that.uniqueId,\n                jqapi.proxy(that.onParentDispose, that)\n            );\n    },\n\n    unbindFromParent: function() {\n        var that = this,\n            $parent = that.constraints;\n\n        if (jqapi.isJqObject($parent)) {\n            $parent.off(\".\" + that.uniqueId);\n        }\n    },\n\n    onParentSelectionChanged: function(e, suggestion, valueChanged) {\n        // Don't clear if parent has been just enriched\n        if (e.type !== \"suggestions-select\" || valueChanged) {\n            this.clear();\n        }\n    },\n\n    onParentDispose: function(e) {\n        this.unbindFromParent();\n    },\n\n    getParentInstance: function() {\n        return (\n            jqapi.isJqObject(this.constraints) && this.constraints.suggestions()\n        );\n    },\n\n    shareWithParent: function(suggestion) {\n        // that is the parent control's instance\n        var that = this.getParentInstance();\n\n        if (\n            !that ||\n            that.type !== this.type ||\n            belongsToArea(suggestion, that)\n        ) {\n            return;\n        }\n\n        that.shareWithParent(suggestion);\n        that.setSuggestion(suggestion);\n    },\n\n    /**\n     * Pick only fields that absent in restriction\n     */\n    getUnrestrictedData: function(data) {\n        var that = this,\n            restrictedKeys = [],\n            unrestrictedData = {},\n            maxSpecificity = -1;\n\n        // Find most specific location that could restrict current data\n        collection_util.each(that.constraints, function(constraint, id) {\n            collection_util.each(constraint.locations, function(location, i) {\n                if (\n                    location.containsData(data) &&\n                    location.specificity > maxSpecificity\n                ) {\n                    maxSpecificity = location.specificity;\n                }\n            });\n        });\n\n        if (maxSpecificity >= 0) {\n            //  -     \n            if (\n                data.region_kladr_id &&\n                data.region_kladr_id === data.city_kladr_id\n            ) {\n                restrictedKeys.push.apply(\n                    restrictedKeys,\n                    that.type.dataComponentsById[\"city\"].fields\n                );\n            }\n\n            // Collect all fieldnames from all restricted components\n            collection_util.each(\n                that.type.dataComponents.slice(0, maxSpecificity + 1),\n                function(component, i) {\n                    restrictedKeys.push.apply(restrictedKeys, component.fields);\n                }\n            );\n\n            // Copy skipping restricted fields\n            collection_util.each(data, function(value, key) {\n                if (restrictedKeys.indexOf(key) === -1) {\n                    unrestrictedData[key] = value;\n                }\n            });\n        } else {\n            unrestrictedData = data;\n        }\n\n        return unrestrictedData;\n    }\n};\n\njqapi.extend(DEFAULT_OPTIONS, optionsUsed$1);\n\njqapi.extend(Suggestions.prototype, methods$5);\n\n// Disable this feature when GET method used. See SUG-202\nif (ajax.getDefaultType() != \"GET\") {\n    notificator\n        .on(\"initialize\", methods$5.createConstraints)\n        .on(\"setOptions\", methods$5.setupConstraints)\n        .on(\"requestParams\", methods$5.constructConstraintsParams)\n        .on(\"dispose\", methods$5.unbindFromParent);\n}\n\n/**\n * Methods for selecting a suggestion\n */\n\nvar methods$6 = {\n    proceedQuery: function(query) {\n        var that = this;\n\n        if (query.length >= that.options.minChars) {\n            that.updateSuggestions(query);\n        } else {\n            that.hide();\n        }\n    },\n\n    /**\n     * Selects current or first matched suggestion, but firstly waits for data ready\n     * @param selectionOptions\n     * @returns {$.Deferred} promise, resolved with index of selected suggestion or rejected if nothing matched\n     */\n    selectCurrentValue: function(selectionOptions) {\n        var that = this,\n            result = jqapi.Deferred();\n\n        // force onValueChange to be executed if it has been deferred\n        that.inputPhase.resolve();\n\n        that.fetchPhase\n            .done(function() {\n                var index;\n\n                // When suggestion has already been selected and not modified\n                if (that.selection && !that.visible) {\n                    result.reject();\n                } else {\n                    index = that.findSuggestionIndex();\n\n                    that.select(index, selectionOptions);\n\n                    if (index === -1) {\n                        result.reject();\n                    } else {\n                        result.resolve(index);\n                    }\n                }\n            })\n            .fail(function() {\n                result.reject();\n            });\n\n        return result;\n    },\n\n    /**\n     * Selects first when user interaction is not supposed\n     */\n    selectFoundSuggestion: function() {\n        var that = this;\n\n        if (!that.requestMode.userSelect) {\n            that.select(0);\n        }\n    },\n\n    /**\n     * Selects current or first matched suggestion\n     * @returns {number} index of found suggestion\n     */\n    findSuggestionIndex: function() {\n        var that = this,\n            index = that.selectedIndex,\n            value;\n\n        if (index === -1) {\n            // matchers always operate with trimmed strings\n            value = that.el.val().trim();\n            if (value) {\n                that.type.matchers.some(function(matcher) {\n                    index = matcher(value, that.suggestions);\n                    return index !== -1;\n                });\n            }\n        }\n\n        return index;\n    },\n\n    /**\n     * Selects a suggestion at specified index\n     * @param index index of suggestion to select. Can be -1\n     * @param {Object} selectionOptions\n     * @param {boolean} [selectionOptions.continueSelecting]  prevents hiding after selection\n     * @param {boolean} [selectionOptions.noSpace]  prevents adding space at the end of current value\n     */\n    select: function(index, selectionOptions) {\n        var that = this,\n            suggestion = that.suggestions[index],\n            continueSelecting =\n                selectionOptions && selectionOptions.continueSelecting,\n            currentValue = that.currentValue,\n            hasSameValues;\n\n        // Prevent recursive execution\n        if (that.triggering[\"Select\"]) return;\n\n        // if no suggestion to select\n        if (!suggestion) {\n            if (!continueSelecting && !that.selection) {\n                that.triggerOnSelectNothing();\n            }\n            that.onSelectComplete(continueSelecting);\n            return;\n        }\n\n        hasSameValues = that.hasSameValues(suggestion);\n\n        that.enrichSuggestion(suggestion, selectionOptions).done(function(\n            enrichedSuggestion,\n            hasBeenEnriched\n        ) {\n            var newSelectionOptions = jqapi.extend(\n                {\n                    hasBeenEnriched: hasBeenEnriched,\n                    hasSameValues: hasSameValues\n                },\n                selectionOptions\n            );\n            that.selectSuggestion(\n                enrichedSuggestion,\n                index,\n                currentValue,\n                newSelectionOptions\n            );\n        });\n    },\n\n    /**\n     * Formats and selects final (enriched) suggestion\n     * @param suggestion\n     * @param index\n     * @param lastValue\n     * @param {Object} selectionOptions\n     * @param {boolean} [selectionOptions.continueSelecting]  prevents hiding after selection\n     * @param {boolean} [selectionOptions.noSpace]  prevents adding space at the end of current value\n     * @param {boolean} selectionOptions.hasBeenEnriched\n     * @param {boolean} selectionOptions.hasSameValues\n     */\n    selectSuggestion: function(suggestion, index, lastValue, selectionOptions) {\n        var that = this,\n            continueSelecting = selectionOptions.continueSelecting,\n            assumeDataComplete =\n                !that.type.isDataComplete ||\n                that.type.isDataComplete.call(that, suggestion),\n            currentSelection = that.selection;\n\n        // Prevent recursive execution\n        if (that.triggering[\"Select\"]) return;\n\n        if (that.type.alwaysContinueSelecting) {\n            continueSelecting = true;\n        }\n\n        if (assumeDataComplete) {\n            continueSelecting = false;\n        }\n\n        // `suggestions` cat be empty, e.g. during `fixData`\n        if (selectionOptions.hasBeenEnriched && that.suggestions[index]) {\n            that.suggestions[index].data = suggestion.data;\n        }\n\n        if (that.requestMode.updateValue) {\n            that.checkValueBounds(suggestion);\n            that.currentValue = that.getSuggestionValue(\n                suggestion,\n                selectionOptions\n            );\n\n            if (\n                that.currentValue &&\n                !selectionOptions.noSpace &&\n                !assumeDataComplete\n            ) {\n                that.currentValue += \" \";\n            }\n            that.el.val(that.currentValue);\n        }\n\n        if (that.currentValue) {\n            that.selection = suggestion;\n            if (!that.areSuggestionsSame(suggestion, currentSelection)) {\n                that.trigger(\n                    \"Select\",\n                    suggestion,\n                    that.currentValue != lastValue\n                );\n            }\n            if (that.requestMode.userSelect) {\n                that.onSelectComplete(continueSelecting);\n            }\n        } else {\n            that.selection = null;\n            that.triggerOnSelectNothing();\n        }\n\n        that.shareWithParent(suggestion);\n    },\n\n    onSelectComplete: function(continueSelecting) {\n        var that = this;\n\n        if (continueSelecting) {\n            that.selectedIndex = -1;\n            that.updateSuggestions(that.currentValue);\n        } else {\n            that.hide();\n        }\n    },\n\n    triggerOnSelectNothing: function() {\n        var that = this;\n\n        if (!that.triggering[\"SelectNothing\"]) {\n            that.trigger(\"SelectNothing\", that.currentValue);\n        }\n    },\n\n    trigger: function(event) {\n        var that = this,\n            args = utils.slice(arguments, 1),\n            callback = that.options[\"on\" + event];\n\n        that.triggering[event] = true;\n        if (utils.isFunction(callback)) {\n            callback.apply(that.element, args);\n        }\n        that.el.trigger.call(\n            that.el,\n            \"suggestions-\" + event.toLowerCase(),\n            args\n        );\n        that.triggering[event] = false;\n    }\n};\n\njqapi.extend(Suggestions.prototype, methods$6);\n\nnotificator.on(\"assignSuggestions\", methods$6.selectFoundSuggestion);\n\n/**\n * features for connected instances\n */\n\nvar optionsUsed$2 = {\n    bounds: null,\n};\n\nvar methods$7 = {\n    setupBounds: function() {\n        this.bounds = {\n            from: null,\n            to: null,\n        };\n    },\n\n    setBoundsOptions: function() {\n        var that = this,\n            boundsAvailable = [],\n            newBounds = $.trim(that.options.bounds).split(\"-\"),\n            boundFrom = newBounds[0],\n            boundTo = newBounds[newBounds.length - 1],\n            boundsOwn = [],\n            boundIsOwn,\n            boundsAll = [];\n\n        if (that.type.dataComponents) {\n            $.each(that.type.dataComponents, function() {\n                if (this.forBounds) {\n                    boundsAvailable.push(this.id);\n                }\n            });\n        }\n\n        if (boundsAvailable.indexOf(boundFrom) === -1) {\n            boundFrom = null;\n        }\n\n        if (boundsAvailable.indexOf(boundTo) === -1) {\n            boundTo = null;\n        }\n\n        if (boundFrom || boundTo) {\n            boundIsOwn = !boundFrom;\n            $.each(boundsAvailable, function(i, bound) {\n                if (bound == boundFrom) {\n                    boundIsOwn = true;\n                }\n                boundsAll.push(bound);\n                if (boundIsOwn) {\n                    boundsOwn.push(bound);\n                }\n                if (bound == boundTo) {\n                    return false;\n                }\n            });\n        }\n\n        that.bounds.from = boundFrom;\n        that.bounds.to = boundTo;\n        that.bounds.all = boundsAll;\n        that.bounds.own = boundsOwn;\n    },\n\n    constructBoundsParams: function() {\n        var that = this,\n            params = {};\n\n        if (that.bounds.from) {\n            params[\"from_bound\"] = { value: that.bounds.from };\n        }\n        if (that.bounds.to) {\n            params[\"to_bound\"] = { value: that.bounds.to };\n        }\n\n        return params;\n    },\n\n    /**\n     *  suggestion.value  that.bounds.own\n     *   ,    suggestion\n     * @param suggestion\n     */\n    checkValueBounds: function(suggestion) {\n        var that = this,\n            valueData;\n\n        // If any bounds set up\n        if (that.bounds.own.length && that.type.composeValue) {\n            //  \n            var bounds = that.bounds.own.slice(0);\n            //         \n            //      city_district_fias_id\n            if (bounds.length === 1 && bounds[0] === \"city_district\") {\n                bounds.push(\"city_district_fias_id\");\n            }\n            valueData = that.copyDataComponents(suggestion.data, bounds);\n            suggestion.value = that.type.composeValue(valueData);\n        }\n    },\n\n    copyDataComponents: function(data, components) {\n        var result = {},\n            dataComponentsById = this.type.dataComponentsById;\n\n        if (dataComponentsById) {\n            $.each(components, function(i, component) {\n                $.each(dataComponentsById[component].fields, function(\n                    i,\n                    field\n                ) {\n                    if (data[field] != null) {\n                        result[field] = data[field];\n                    }\n                });\n            });\n        }\n\n        return result;\n    },\n\n    getBoundedKladrId: function(kladr_id, boundsRange) {\n        var boundTo = boundsRange[boundsRange.length - 1],\n            kladrFormat;\n\n        $.each(this.type.dataComponents, function(i, component) {\n            if (component.id === boundTo) {\n                kladrFormat = component.kladrFormat;\n                return false;\n            }\n        });\n\n        return (\n            kladr_id.substr(0, kladrFormat.digits) +\n            new Array((kladrFormat.zeros || 0) + 1).join(\"0\")\n        );\n    },\n};\n\n$.extend(DEFAULT_OPTIONS, optionsUsed$2);\n\n$.extend(Suggestions.prototype, methods$7);\n\nnotificator\n    .on(\"initialize\", methods$7.setupBounds)\n    .on(\"setOptions\", methods$7.setBoundsOptions)\n    .on(\"requestParams\", methods$7.constructBoundsParams);\n\n/**\n *     DOM.\n */\nvar dom = {\n    /**\n     *      .\n     */\n    selectByClass: function(classname, parent) {\n        var selector = \".\" + classname;\n        if (parent) {\n            return parent.querySelector(selector);\n        } else {\n            return document.querySelector(selector);\n        }\n    },\n\n    /**\n     *   .\n     */\n    addClass: function(element, className) {\n        var list = element.className.split(\" \");\n        if (list.indexOf(className) === -1) {\n            list.push(className);\n        }\n        element.className = list.join(\" \");\n    },\n\n    /**\n     *   .\n     */\n    setStyle: function(element, name, value) {\n        element.style[name] = value;\n    },\n\n    /**\n     *     .\n     * @param {Element} element - \n     * @param {string} eventName -  \n     * @param {string} namespace -   \n     * @param {Function} callback - - \n     */\n    listenTo: function(element, eventName, namespace, callback) {\n        element.addEventListener(eventName, callback, false);\n        if (namespace) {\n            if (!eventsByNamespace[namespace]) {\n                eventsByNamespace[namespace] = [];\n            }\n            eventsByNamespace[namespace].push({\n                eventName: eventName,\n                element: element,\n                callback: callback\n            });\n        }\n    },\n\n    /**\n     *        .\n     */\n    stopListeningNamespace: function(namespace) {\n        var events = eventsByNamespace[namespace];\n        if (events) {\n            events.forEach(function(event) {\n                event.element.removeEventListener(\n                    event.eventName,\n                    event.callback,\n                    false\n                );\n            });\n        }\n    }\n};\n\n/**\n * -   .\n */\nvar FREE_PLAN = \"FREE\";\nvar LINK =\n    \"https://dadata.ru/suggestions/?utm_source=dadata&utm_medium=module&utm_campaign=suggestions-jquery\";\nvar PREFIX = \"\";\nvar SUFFIX = \"\";\nvar IMAGE =\n    '<svg version=\"1.1\" viewBox=\"0 0 128 38\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"m128 19v16.077c0 1.614-1.302 2.923-2.909 2.923h-122.18c-1.607 0-2.909-1.309-2.909-2.923v-32.154c-0-1.614 1.302-2.923 2.909-2.923h122.18c1.607 0 2.909 1.309 2.909 2.923z\" fill=\"#ef4741\"/><path d=\"m59.52 7.912h-8.902v22.098h9.92c3.724 0 9.872-0.341 9.872-6.703v-8.682c-0.01-6.372-7.166-6.713-10.89-6.713zm5.595 14.81c0 3.186-2.308 3.508-4.936 3.508h-4.276v-14.538h3.287c2.628 0 5.954 0.322 5.954 3.508zm-46.545-14.81h-8.834v22.098h9.871c3.724 0 9.872-0.341 9.872-6.703v-8.682c0-6.372-7.137-6.713-10.88-6.713zm5.595 14.81c0 3.186-2.308 3.508-4.936 3.508h-4.247v-14.538h3.258c2.628 0 5.954 0.322 5.954 3.508zm71.757-13.953h-4.945v16.301c-0.018 0.785 0.113 1.565 0.388 2.3 0.203 0.569 0.535 1.082 0.97 1.5 0.446 0.385 0.962 0.677 1.522 0.858 0.58 0.205 1.182 0.343 1.794 0.409 0.575 0.052 1.248 0.081 2.017 0.088 0.917-1e-3 1.834-0.057 2.744-0.166v-2.796h-1.765c-0.393 0.055-0.795 0.032-1.18-0.071-0.385-0.102-0.745-0.28-1.06-0.524-0.413-0.691-0.59-1.498-0.504-2.299v-8.068h4.509v-3.06h-4.509zm20.364 5.535c-1.176-0.741-3.278-1.108-6.303-1.101h-5.741v0.243l0.708 2.826h5.033c0.837-0.051 1.672 0.117 2.424 0.487 0.259 0.248 0.458 0.553 0.579 0.891 0.121 0.339 0.162 0.701 0.119 1.058v1.12h-5.527c-1.939 0-3.271 0.38-3.995 1.14-0.725 0.76-1.099 2.127-1.125 4.102 0 2.154 0.359 3.06 1.086 3.742 0.728 0.682 2.134 1.188 4.344 1.188h6.847c1.706 0 3.345-0.808 3.345-2.747v-8.584c0-2.176-0.589-3.635-1.765-4.375zm-3.19 12.959h-3.249c-0.735 0.081-1.478-0.036-2.152-0.342-0.285-0.227-0.427-0.876-0.427-1.948s0.136-1.741 0.407-2.007c0.625-0.331 1.336-0.46 2.037-0.371h3.384zm-26.667-12.959c-1.176-0.741-3.277-1.108-6.303-1.101h-5.741v0.243l0.708 2.826h5.033c0.836-0.051 1.672 0.117 2.424 0.487 0.259 0.248 0.457 0.553 0.578 0.891 0.121 0.339 0.162 0.701 0.12 1.058v1.12h-5.556c-1.939 0-3.271 0.38-3.995 1.14s-1.086 2.127-1.086 4.102c0 2.154 0.359 3.06 1.086 3.742s2.133 1.188 4.344 1.188h6.846c1.717 0 3.346-0.808 3.346-2.747v-8.584c-7e-3 -2.176-0.595-3.635-1.765-4.375zm-3.181 12.959h-3.248c-0.735 0.081-1.478-0.037-2.153-0.342-0.284-0.227-0.426-0.876-0.426-1.948s0.135-1.741 0.407-2.007c0.624-0.331 1.336-0.46 2.036-0.371h3.384zm-37.74-12.959c-1.176-0.741-3.278-1.108-6.303-1.101h-5.712v0.243l0.708 2.826h5.033c0.837-0.051 1.672 0.117 2.424 0.487 0.259 0.248 0.457 0.553 0.578 0.891 0.121 0.339 0.162 0.701 0.12 1.058v1.12h-5.556c-1.939 0-3.271 0.38-3.995 1.14s-1.099 2.127-1.125 4.102c0 2.154 0.359 3.06 1.086 3.742s2.133 1.188 4.344 1.188h6.846c1.717 0 3.346-0.808 3.346-2.747v-8.584c0-2.176-0.589-3.635-1.765-4.375zm-3.181 12.959h-3.219c-0.735 0.081-1.478-0.037-2.153-0.342-0.284-0.227-0.427-0.876-0.427-1.948s0.136-1.741 0.408-2.007c0.624-0.331 1.336-0.46 2.036-0.371h3.384z\" fill=\"#fff\"/></svg>';\n\nfunction Promo(plugin) {\n    this.plan = plugin.status.plan;\n    var container = plugin.getContainer();\n    this.element = dom.selectByClass(CLASSES.promo, container);\n}\n\nPromo.prototype.show = function() {\n    if (this.plan !== FREE_PLAN) {\n        return;\n    }\n    if (!this.element) {\n        return;\n    }\n    this.setStyles();\n    this.setHtml();\n};\n\nPromo.prototype.setStyles = function() {\n    this.element.style.display = \"block\";\n};\n\nPromo.prototype.setHtml = function() {\n    this.element.innerHTML =\n        '<a target=\"_blank\" tabindex=\"-1\" href=\"' +\n        LINK +\n        '\">' +\n        PREFIX +\n        IMAGE +\n        SUFFIX +\n        \"</a>\";\n};\n\nfunction show() {\n    new Promo(this).show();\n}\n\nnotificator.on(\"assignSuggestions\", show);\n\nSuggestions.defaultOptions = DEFAULT_OPTIONS;\n\nSuggestions.version = \"22.6.0\";\n\n$.Suggestions = Suggestions;\n\n// Create chainable jQuery plugin:\n$.fn.suggestions = function(options, args) {\n    // If function invoked without argument return\n    // instance of the first matched element:\n    if (arguments.length === 0) {\n        return this.first().data(DATA_ATTR_KEY);\n    }\n\n    return this.each(function() {\n        var inputElement = $(this),\n            instance = inputElement.data(DATA_ATTR_KEY);\n\n        if (typeof options === \"string\") {\n            if (instance && typeof instance[options] === \"function\") {\n                instance[options](args);\n            }\n        } else {\n            // If instance already exists, destroy it:\n            if (instance && instance.dispose) {\n                instance.dispose();\n            }\n            instance = new Suggestions(this, options);\n            inputElement.data(DATA_ATTR_KEY, instance);\n        }\n    });\n};\n\n})));\n"],"sourceRoot":""}